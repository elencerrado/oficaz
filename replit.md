# Oficaz - Employee Management System

## Overview

Oficaz is a comprehensive employee management system built with a modern full-stack architecture. The application provides time tracking, vacation management, document handling, messaging, and administrative features for companies and their employees.

## System Architecture

### Frontend Architecture
- **Framework**: React 18 with TypeScript
- **Routing**: Wouter for client-side routing
- **Styling**: Tailwind CSS with shadcn/ui component library
- **State Management**: TanStack Query (React Query) for server state
- **Form Handling**: React Hook Form with Zod validation
- **Build Tool**: Vite for fast development and optimized builds

### Backend Architecture
- **Runtime**: Node.js with Express.js
- **Language**: TypeScript with ES modules
- **Database**: PostgreSQL with Drizzle ORM
- **Authentication**: JWT-based authentication with role-based access control
- **File Uploads**: Multer for handling document uploads
- **Session Management**: Express sessions with PostgreSQL store

### Database Design
- **ORM**: Drizzle with PostgreSQL dialect
- **Schema**: Type-safe schema definitions shared between frontend and backend
- **Tables**: Companies, Users, Work Sessions, Vacation Requests, Documents, Messages
- **Relationships**: Foreign key constraints with proper referential integrity

## Key Components

### Authentication System
- JWT token-based authentication
- Role-based access control (admin, manager, employee)
- Secure password hashing with bcrypt
- Token refresh mechanism
- Protected routes with middleware

### Time Tracking Module
- Real-time clock in/out functionality
- Automatic time calculation
- Work session history
- Weekly/monthly time summaries
- Company-wide time tracking (admin/manager view)

### Vacation Management
- Vacation request submission
- Approval workflow (pending ‚Üí approved/denied)
- Vacation balance tracking
- Calendar integration for date selection
- Manager/admin approval interface

### Document Management
- File upload functionality
- Document categorization
- Secure file storage
- Download and deletion capabilities
- User-specific document access

### Messaging System
- Internal company messaging
- Real-time message updates
- Role-based message routing
- Message history and search

### Administrative Features
- Employee management (admin/manager only)
- Company settings configuration
- User role management
- System-wide statistics and reporting

## Data Flow

1. **Authentication Flow**: User credentials ‚Üí JWT token ‚Üí Role-based access
2. **Time Tracking Flow**: Clock in/out ‚Üí Database update ‚Üí Real-time UI refresh
3. **Vacation Request Flow**: Request submission ‚Üí Manager review ‚Üí Status update
4. **Document Flow**: File upload ‚Üí Server storage ‚Üí Database metadata
5. **Message Flow**: Compose ‚Üí Send ‚Üí Real-time delivery ‚Üí Notification

## External Dependencies

### Frontend Dependencies
- **UI Components**: Radix UI primitives with shadcn/ui
- **Data Fetching**: TanStack Query for server state management
- **Date Handling**: date-fns for date manipulation
- **Form Validation**: Zod schema validation
- **Styling**: Tailwind CSS with custom Oficaz theme

### Backend Dependencies
- **Database**: Neon PostgreSQL serverless database
- **ORM**: Drizzle ORM with type-safe queries
- **Authentication**: JWT and bcrypt for security
- **File Handling**: Multer for multipart form data
- **Session Storage**: connect-pg-simple for PostgreSQL sessions

## Deployment Strategy

### Development Environment
- **Runtime**: Node.js 20 with TypeScript compilation
- **Database**: PostgreSQL 16 (Replit managed)
- **Dev Server**: Vite development server with HMR
- **Port Configuration**: Frontend on 5000, API on same port

### Production Build
- **Frontend**: Vite build with optimized assets
- **Backend**: esbuild compilation to ESM format
- **Static Assets**: Served from dist/public directory
- **Database Migrations**: Drizzle kit for schema management

### Replit Configuration
- **Modules**: nodejs-20, web, postgresql-16
- **Build Command**: `npm run build`
- **Start Command**: `npm run start`
- **Development**: `npm run dev`
- **Auto-scaling**: Configured for production deployment

## User Preferences

### Design Standards
- **Header Layout**: Always use consistent header format across admin pages:
  - Simple header with mb-6 margin (NO white background container)
  - px-6 py-4 min-h-screen bg-gray-50 with overflowX: 'clip'
  - h1 with text-2xl font-semibold text-gray-900 (simple title)
  - p with text-gray-500 mt-1 (descriptive subtitle)
  - Follow exact time-tracking.tsx pattern for consistency
- **User expects consistency**: Header and margins must follow the same pattern as time-tracking and other admin pages
- **No custom containers**: Always follow the px-6 py-4 pattern, never use max-w-7xl containers with border-bottom

### Code Protection Standards
- **Critical Functions Must Be Protected**: User has experienced functionality regression issues
- **Protected Code Sections**: Use ‚ö†Ô∏è PROTECTED comments with "DO NOT MODIFY" warnings
- **Document Classification**: The analyzeFileName function is CRITICAL and must remain stable
- **User Requirement**: "Blindfold" (protect/secure) critical functionality to prevent breaking changes
- **Protection Pattern**: Wrap critical functions with warning comments and clear boundaries

## Conceptos de Fechas en Sistema de Suscripciones

### Diferencia Cr√≠tica: Trial End vs Next Payment Date

El sistema maneja dos conceptos de fecha independientes que pueden divergir:

1. **trial_end_date**: Fecha l√≠mite cuando la web deja de ser operativa sin pago
   - Se establece al registro: trial_start_date + 14 d√≠as
   - NO se modifica una vez establecida
   - Determina cu√°ndo bloquear acceso a la aplicaci√≥n

2. **next_payment_date**: Fecha del pr√≥ximo cobro de suscripci√≥n
   - Se calcula al confirmar m√©todo de pago
   - Si el usuario a√±ade pago ANTES del trial_end_date: next_payment_date = trial_end_date + 1 mes
   - Si el usuario a√±ade pago DESPU√âS del trial_end_date: next_payment_date = fecha_actual + 1 mes

### Escenarios Posibles:
- **Pago Puntual**: Trial expira 3 jul, usuario paga antes (25 jun) ‚Üí cobro 3 agosto (mes siguiente al fin del trial)
- **Pago Tard√≠o**: Trial expira 3 jul, usuario paga despu√©s (10 jul) ‚Üí cobro 10 agosto (un mes desde que a√±adi√≥ pago)

### Estado Actual del Sistema:
- ‚úÖ Base de datos con firstPaymentDate y nextPaymentDate separados
- ‚úÖ L√≥gica de c√°lculo completa implementada en confirm-payment-method
- ‚úÖ Esquema actualizado con campo first_payment_date
- ‚úÖ Migraci√≥n aplicada exitosamente
- ‚úÖ Mensajes personalizados seg√∫n escenario de pago

## Estado Actual del Sistema de Fichaje Admin

### PROBLEMA RESUELTO (28 Junio 2025)
- **Problema Original**: Usuario reporta errores al fichar desde dashboard admin
- **Causa Identificada**: Overflow num√©rico en campo totalHours por sesiones con fechas muy antiguas
- **Soluci√≥n Implementada**: 
  - Validaci√≥n de duraci√≥n m√°xima 24 horas en endpoint clock-out
  - Verificaci√≥n de fechas v√°lidas (salida no anterior a entrada)
  - Limitaci√≥n segura del campo totalHours (0-24 horas m√°ximo)
  - Logs de debugging eliminados para versi√≥n de producci√≥n
- **Estado FINAL**: Sistema de fichaje admin completamente funcional y protegido contra overflow

### VISIBILIDAD DE FICHAJES ADMIN CORREGIDA (28 Junio 2025)
- **Problema**: Fichajes del admin no aparec√≠an en p√°gina de control horario
- **Causa**: Filtro en time-tracking.tsx exclu√≠a sesiones con userRole === 'admin'
- **Soluci√≥n**: Eliminado filtro restrictivo para incluir todas las sesiones
- **Resultado**: Admin ahora ve sus propios fichajes junto con los del equipo
- **Limpieza**: Eliminados registros de prueba del admin del d√≠a actual

## Changelog

- July 1, 2025. INCONSISTENCIA VISUAL DE AVATARES CORREGIDA DEFINITIVAMENTE: Estructura unificada implementada
  - PROBLEMA RESUELTO: Avatar sin foto (l√≠nea 235) ahora usa misma estructura que avatar con foto (l√≠nea 189)
  - ESTRUCTURA UNIFICADA: Ambos tipos usan contenedor exterior (borde+padding+fondo blanco) + contenedor interior
  - EST√âTICA CONSISTENTE: Eliminada diferencia visual entre avatares con/sin foto en fichajes admin
  - SISTEMA BLINDADO: Todos los avatares en aplicaci√≥n siguen exactamente la misma l√≥gica visual
  - RESULTADO FINAL: Perfecta armon√≠a visual entre avatares con fotos reales vs iniciales de colores
- July 1, 2025. SISTEMA DE AVATARES COMPLETAMENTE FINALIZADO: Display de fotos de perfil funcional en toda la aplicaci√≥n
  - COMPLETADAS TODAS LAS CORRECCIONES: Todas las instancias de UserAvatar ahora incluyen profilePicture prop
  - P√ÅGINAS ACTUALIZADAS: messages.tsx (8 instancias), vacation-management.tsx, mobile-header.tsx, messages-backup.tsx (3 instancias)
  - SISTEMA UNIFICADO: Display consistente de fotos de perfil vs iniciales de colores en toda la aplicaci√≥n
  - FUNCIONALIDAD COMPLETA: Avatares muestran fotos reales cuando est√°n disponibles o fallback a iniciales con colores √∫nicos
  - VERIFICACI√ìN EXITOSA: Confirmado que no quedan instancias sin profilePicture prop en el sistema
  - PATR√ìN T√âCNICO: profilePicture={user?.profilePicture} aplicado sistem√°ticamente en todos los componentes UserAvatar
- July 1, 2025. BUG CR√çTICO DE DISPLAY DE ROLES EN CHAT RESUELTO: Sistema de mensajes empleado completamente funcional
  - PROBLEMA RESUELTO: Admin Andr√©s aparec√≠a como "sin cargo definido" en chat de empleados
  - CAUSA IDENTIFICADA: M√∫ltiples ubicaciones usaban campos inexistentes (jobTitle, position) en base de datos
  - SOLUCI√ìN APLICADA: Sistema ahora usa campo position din√°mico del perfil con fallback inteligente
  - BACKEND CORREGIDO: /api/managers endpoint ahora incluye campo position para datos completos
  - FRONTEND CORREGIDO: Todas las ubicaciones usan position || fallback role-based descriptions
  - MAPEO ESPA√ëOL FALLBACK: admin="Director General", manager="Responsable", employee="Empleado"
  - UBICACIONES CORREGIDAS: getRoleDisplay funci√≥n, lista de managers, header de chat individual
  - FUNCIONALIDAD RESTAURADA: Chat muestra cargo real del perfil o fallback seg√∫n rol
  - SISTEMA VERIFICADO: Roles din√°micos funcionando correctamente en todas las vistas del chat
- June 30, 2025. BUG CR√çTICO DE DESCARGA DE DOCUMENTOS RESUELTO: Sistema empleado completamente funcional
  - PROBLEMA RESUELTO: Error "invalid or expired token" en descarga de documentos empleado
  - CAUSA IDENTIFICADA: Frontend enviaba token por query param pero backend solo aceptaba headers Authorization
  - MIDDLEWARE CREADO: authenticateTokenOrQuery permite autenticaci√≥n por header o query parameter
  - ENDPOINT CORREGIDO: /api/documents/:id/download ahora acepta ?token=${token} para descargas directas
  - FUNCIONALIDAD EMPLEADO: Descarga y visualizaci√≥n de documentos funcionando correctamente
- June 30, 2025. BUG CR√çTICO DE ELIMINACI√ìN PERMANENTE RESUELTO: Sistema super admin completamente funcional
  - PROBLEMA RESUELTO: Error en eliminaci√≥n permanente por tablas inexistentes (document_notifications, custom_holidays)
  - ENDPOINT CORREGIDO: /api/super-admin/companies/:id/delete-permanently actualizado para usar solo tablas existentes
  - SISTEMA VERIFICADO: Eliminaci√≥n completa funciona correctamente eliminando datos en cascada
  - STATUS BADGES CORREGIDOS: Empresas trial ahora muestran "Prueba" (azul), activas "Activo" (verde), inactivas "Inactivo" (gris)
  - FUNCIONALIDAD COMPLETA: Super admin puede eliminar empresas permanentemente sin errores de base de datos
- June 30, 2025. UNIFICACI√ìN DE EMAIL CORPORATIVO Y FACTURACI√ìN COMPLETADA: Sistema completamente coherente implementado
  - BACKEND UNIFICADO: billing_email ahora usa directamente company.email eliminando fallbacks complejos
  - STRIPE INTEGRADO: Endpoints create-setup-intent y confirm-payment-method usan company.email para customers
  - FRONTEND ACTUALIZADO: Ambas p√°ginas (registro y configuraci√≥n) usan "Email corporativo / facturaci√≥n" como label
  - TERMINOLOG√çA COHERENTE: Sistema clarifica que el email de empresa sirve para comunicaciones Y facturaci√≥n
  - EXPLICACI√ìN A√ëADIDA: Texto descriptivo en registro explica el uso dual del email corporativo
  - CONSISTENCIA TOTAL: Ya no existe separaci√≥n entre email empresa vs email facturaci√≥n
  - SIMPLIFICACI√ìN LOGICA: Eliminada complejidad de fallbacks (admin?.companyEmail || admin?.personalEmail || company.email)
  - FACTURAS STRIPE: Todas las facturas de Stripe ahora usan el email corporativo unificado (info@test.com)
- June 30, 2025. CONSOLIDACI√ìN DE BASE DE DATOS COMPLETADA: Eliminaci√≥n definitiva de tabla company_configs
  - MIGRACI√ìN EXITOSA: Todos los datos de configuraci√≥n de empresa movidos a tabla companies
  - BACKEND ACTUALIZADO: Todas las funciones ahora usan companies table directamente
  - TABLA ELIMINADA: company_configs completamente removida de la base de datos usando DROP TABLE
  - SISTEMA LIMPIO: Ya no existen referencias a company_config en c√≥digo ni base de datos
  - FUNCIONALIDAD PRESERVADA: C√°lculos de vacaciones y configuraciones funcionando normalmente
  - CONSOLIDACI√ìN TOTAL: Arquitectura simplificada con una sola tabla para datos de empresa
- June 30, 2025. TAMA√ëOS DE AVATARES FINALMENTE AJUSTADOS: Equilibrio perfecto entre visibilidad y proporci√≥n
  - ITERACI√ìN FINAL: Ajustados a tama√±os √≥ptimos tras feedback del usuario para mejor visibilidad
  - TAMA√ëOS DEFINITIVOS: sm=30px, md=36px, lg=44px (equilibrio entre compacto y visible)
  - FUENTES OPTIMIZADAS: sm=12px, md=13px, lg=15px para legibilidad perfecta
  - BORDES MANTIENEN PROPORCI√ìN: 2px para sm/md, 3px para lg
  - RESULTADO FINAL: Avatares con visibilidad √≥ptima sin ser demasiado grandes para la UI
- June 30, 2025. PROBLEMA CR√çTICO DE COMANDOS SED SOLUCIONADO: Restauraci√≥n precisa de tama√±os de botones completada
  - CAUSA IDENTIFICADA: Comando sed anterior cambi√≥ accidentalmente Button components de size="sm" a size="md"
  - SOLUCI√ìN APLICADA: Correcci√≥n selectiva para restaurar solo Button components a size="sm" manteniendo UserAvatar size="md"
  - M√âTODO UTILIZADO: Comando sed espec√≠fico para Button con patr√≥n /Button/,/onClick/ para precision quir√∫rgica
  - AVATARES PRESERVADOS: Todos los UserAvatar mantienen correctamente size="md" seg√∫n est√°ndar unificado
  - RESULTADO FINAL: Botones con size="sm" para UI compacta, avatares con tama√±os optimizados
  - LECCI√ìN T√âCNICA: Los comandos sed requieren patrones precisos para evitar efectos colaterales en componentes similares
- June 30, 2025. SISTEMA DE AVATARES COMPLETAMENTE UNIFICADO: Consistencia total de tama√±os y formas garantizada
  - PROBLEMA RA√çZ IDENTIFICADO: Componente Avatar de shadcn/ui ten√≠a tama√±o fijo h-10 w-10 (40px) vs UserAvatar din√°mico (32px/40px/48px)
  - SOLUCI√ìN DEFINITIVA: Aplicadas propiedades anti-deformaci√≥n id√©nticas a componente Avatar de shadcn
  - PROPIEDADES CR√çTICAS A√ëADIDAS: min-w/min-h/max-w/max-h-[40px], flexShrink: 0, aspectRatio: '1'
  - LIMPIEZA DE C√ìDIGO: Eliminadas importaciones innecesarias de Avatar en mobile-header.tsx y employees-simple.tsx
  - CONSISTENCIA GARANTIZADA: Ambos sistemas de avatares (UserAvatar y shadcn Avatar) ahora perfectamente alineados
  - SISTEMA BLINDADO: Resistente a deformaciones por CSS externo en cualquier contexto de layout
  - RESULTADO FINAL: Tama√±os uniformes y formas circulares perfectas en toda la aplicaci√≥n
- June 30, 2025. PROBLEMA CR√çTICO DE AVATARES EL√çPTICOS RESUELTO: Refuerzo anti-deformaci√≥n implementado
  - PROBLEMA IDENTIFICADO: UserAvatar se deformaba a elipses en pantallas peque√±as por layout constraints
  - SOLUCI√ìN ROBUSTA: Agregadas propiedades CSS cr√≠ticas para mantener forma circular perfecta:
    * minWidth/minHeight/maxWidth/maxHeight para evitar compresi√≥n por contenedores padre
    * flexShrink: 0 para prevenir encogimiento autom√°tico en flex containers
    * aspectRatio: '1' para forzar ratio 1:1 perfecto en navegadores modernos
  - APLICADO EN TODOS LOS CONTEXTOS: Avatar simple, avatar con upload, y contenedores internos
  - BLINDAJE COMPLETO: Sistema resistente a cualquier CSS externo que pueda afectar dimensiones
  - TAMA√ëOS GARANTIZADOS: sm=32px, md=40px, lg=48px siempre circulares sin deformaci√≥n
- June 28, 2025. SISTEMA DE AVATARES FINALMENTE PERFECCIONADO: Tama√±o din√°mico implementado completamente
  - TAMA√ëO DIN√ÅMICO IMPLEMENTADO: UserAvatar ahora usa sizeConfig din√°mico en lugar de valores hardcodeados
  - ESCALADO CORRECTO: size="sm" (32px), size="md" (40px), size="lg" (48px) funcionando perfectamente
  - FUENTES ADAPTATIVAS: fontSize tambi√©n escalable seg√∫n tama√±o (12px, 14px, 16px)
  - COMPONENTE ROBUSTO: L√≥gica unificada para fotos con bordes de colores e iniciales con fondos de colores
  - VERIFICACI√ìN COMPLETA: Todas las p√°ginas usando UserAvatar correctamente sin implementaciones manuales restantes
  - SISTEMA BLINDADO: Estilos inline puros eliminan dependencias CSS que puedan interferir
  - FUNCIONALIDAD UPLOAD: Sistema de carga de fotos integrado con fallback autom√°tico a iniciales
  - COLORES √öNICOS: Hash por userId garantiza colores distintivos permanentes por empleado
- June 28, 2025. DATE PICKER REDISE√ëADO: Sistema calendario implementado siguiendo solicitud del usuario
  - CAMBIO CR√çTICO: DatePickerDay ahora usa formato calendario (Dialog + Calendar) igual al filtro de rango
  - DatePickerDayEmployee mantiene formato dropdown exclusivamente para fechas de incorporaci√≥n
  - Distinci√≥n clara: calendario para fechas generales, dropdown solo para incorporaci√≥n de empleados
  - Estructura id√©ntica al DatePickerPeriod con Dialog, Calendar mode="single" y botones Cancelar/Limpiar
  - Implementado seg√∫n √©nfasis del usuario: "calendario normal!!!!" para m√°xima usabilidad
- June 28, 2025. AVATARES √öNICOS FINALMENTE FUNCIONANDO: Soluci√≥n definitiva con estilos inline puros
  - PROBLEMA CR√çTICO RESUELTO: shadcn/ui CSS causaba interferencias, eliminado TODO uso de clases CSS
  - UserAvatar completamente reescrito: solo estilos inline style={{}} sin ninguna clase
  - 18 colores √∫nicos garantizados: userId determina color hexadecimal directo (#3B82F6, #10B981, etc)
  - Tama√±os fijos en pixeles: 32px/40px/48px sin clases responsive que puedan interferir
  - Especificidad m√°xima: estilos inline no pueden ser sobrescritos por CSS externo alguno
  - Sistema blindado: sin dependencias de Tailwind o shadcn que puedan causar regresiones futuras
- June 28, 2025. SISTEMA DE AVATARES √öNICOS COMPLETAMENTE FINALIZADO: Todas las instancias corregidas exitosamente
  - MESSAGES.TSX COMPLETAMENTE CORREGIDO: 8 instancias de UserAvatar actualizadas sistem√°ticamente
  - Eliminadas TODAS las className personalizadas que bloqueaban el sistema de colores √∫nicos
  - Correcciones en l√≠neas: 543, 574, 732, 771, 982, 1095, 1162 con userId prop aplicado
  - Sistema hash por userId funcionando perfectamente en toda la aplicaci√≥n
  - TODAS LAS P√ÅGINAS UNIFICADAS: time-tracking, messages, employees, vacation-management usando colores √∫nicos
  - UserAvatar ahora genera colores autom√°ticamente por userId sin interferencias de className
  - Sistema completamente estable: cada empleado mantiene color distintivo permanente en todas las vistas
- June 28, 2025. PROBLEMA CR√çTICO DE COLORES DE AVATARES RESUELTO: Sistema completamente funcional
  - PROBLEMA CR√çTICO SOLUCIONADO: Color oficaz-primary agregado directamente a tailwind.config.ts 
  - Definici√≥n HSL correcta implementada: hsl(211, 100%, 50%) en configuraci√≥n de Tailwind
  - Sistema de avatares UserAvatar funcionando consistentemente con color azul corporativo #007AFF
  - Avatar a√±adido junto al nombre en tabla de fichajes de time-tracking.tsx con size="sm"
  - Importaci√≥n correcta de UserAvatar agregada a time-tracking.tsx
  - Todos los avatares ahora muestran color uniforme y consistente en toda la aplicaci√≥n
- June 28, 2025. COMPONENTE USERAVATAR OPTIMIZADO Y AVATARES REEMPLAZADOS COMPLETAMENTE: Sistema de avatares unificado
  - COMPONENTE USERAVATAR MEJORADO: L√≥gica simplificada para aplicar correctamente colores personalizados sin conflictos
  - REEMPLAZADOS 8 AVATARES EN MENSAJES: Chat header, lista empleados, modal empleados, modal managers, chat m√≥vil
  - COLORES PERSONALIZADOS PRESERVADOS: bg-oficaz-primary text-white, bg-white/20 text-white seg√∫n contexto
  - L√ìGICA CONDICIONAL OPTIMIZADA: className personalizada tiene prioridad completa sobre colores por defecto
  - ELIMINADOS COLORES POR DEFECTO PROBLEM√ÅTICOS: ya no interfieren con especificaciones personalizadas
  - COMPONENTE ROBUSTO: maneja casos con y sin className de forma inteligente y consistente
  - SISTEMA DE AVATARES UNIFICADO: todas las p√°ginas ahora usan UserAvatar en lugar de implementaciones manuales
- June 28, 2025. FALSAS DETECCIONES DE FECHAS CORREGIDAS DEFINITIVAMENTE: Sistema de an√°lisis perfectamente blindado
  - PROBLEMA CR√çTICO RESUELTO: "mar" en apellidos como "Mart√≠n" era detectado como "marzo" agregando fechas falsas
  - CAUSA IDENTIFICADA: Expresi√≥n regular detectaba "mar" en "Marti" interpret√°ndolo como abreviatura de marzo
  - SOLUCI√ìN T√âCNICA APLICADA: 
    * Eliminada abreviatura "mar" del mapeo de meses para evitar falsos positivos
    * Detecci√≥n de meses num√©ricos solo con separadores expl√≠citos (guiones, espacios)
    * B√∫squeda de palabras completas con l√≠mites (\b) para nombres de meses
    * Limpieza de separadores antes de mapear n√∫meros a meses
  - RESULTADO VERIFICADO: "Contrato - Juan Jos√© Ramirez Marti.pdf" ‚Üí "Contrato - Juan Jos√© Ramirez Mart√≠n.pdf" SIN "Marzo 2025"
  - FUNCI√ìN PROTEGIDA: generateCleanFileName blindada con comentarios ‚ö†Ô∏è PROTECTED contra futuras regresiones
  - DETECCI√ìN DE MESES PROTEGIDA: L√≥gica cr√≠tica de monthMatch documentada y blindada
  - SISTEMA ROBUSTO: An√°lisis inteligente funcionando sin interferencias de nombres de personas
- June 28, 2025. ANALIZADOR DE DOCUMENTOS COMPLETAMENTE RESTAURADO: Sistema inteligente funcionando perfectamente
  - PROBLEMA CR√çTICO RESUELTO: Lista vac√≠a en analizador de documentos por logs de debugging que interfer√≠an
  - Funci√≥n analyzeFileName restaurada a versi√≥n limpia sin logs que bloqueaban la detecci√≥n
  - Detecci√≥n autom√°tica funcionando: "nomina junio 2025 - juan jose ramirez.pdf" ‚Üí "N√≥mina" + empleado correcto
  - Sistema completo: detecta tipos de documento (N√≥mina, Contrato, Justificante, DNI, Otros) y empleados
  - Generaci√≥n de nombres limpios funcionando: formato "Tipo - Empleado - Fecha.extensi√≥n"
  - Modal de an√°lisis inteligente mostrando correctamente todos los archivos seleccionados
  - Eliminados todos los logs de debugging que causaban interferencias en producci√≥n
- June 28, 2025. AUTO-SCROLL DEL CHAT CORREGIDO DEFINITIVAMENTE: M√©todos m√∫ltiples para todos los contenedores
  - PROBLEMA CR√çTICO RESUELTO: Auto-scroll implementado con 3 m√©todos simult√°neos para m√°xima compatibilidad
  - M√âTODO 1: messagesEndRef.scrollIntoView() como m√©todo principal directo
  - M√âTODO 2: Seleccores CSS espec√≠ficos para cada vista:
    * Vista admin desktop: `.flex-1.overflow-y-auto.p-4.bg-gray-50`
    * Vista admin m√≥vil: `.flex-1.overflow-y-auto.px-4.bg-gray-50`
    * Vista empleado: `.min-h-screen.bg-employee-gradient .overflow-y-auto`
  - M√âTODO 3: messagesContainerRef.current.scrollTop para referencias directas
  - Sistema robusto: m√∫ltiples intentos de scroll para garantizar funcionamiento en todos los layouts
  - Aplicado tanto en useEffect (mensajes nuevos) como en sendMessage (env√≠o manual)
  - DOCUMENTADO PARA FUTURAS REFERENCIAS: problema recurrente resuelto con enfoque exhaustivo
- June 28, 2025. AUTO-SCROLL DEL CHAT RESTAURADO COMPLETAMENTE: Funci√≥n robusta con m√∫ltiples contenedores
  - PROBLEMA CR√çTICO RESUELTO: Auto-scroll perdido otra vez en chat empleado (l√≠nea 572 messages.tsx)
  - Funci√≥n de scroll mejorada con 6 selectores diferentes para encontrar contenedor correcto
  - Logs de debugging a√±adidos para detectar problemas futuros con contenedores de mensajes
  - Auto-scroll forzado tambi√©n al enviar mensaje (500ms delay) para asegurar funcionamiento
  - Sistema PROTEGIDO con comentarios ‚ö†Ô∏è para prevenir regresiones futuras
  - Funciona tanto en vista m√≥vil como desktop, empleado y admin
- June 28, 2025. L√ìGICA DE MENSAJES DE PAGO COMPLETAMENTE REFINADA: Sistema inteligente seg√∫n estado exacto
  - CASO 1: Sin m√©todo de pago + trial activo ‚Üí "Tu per√≠odo de prueba terminar√° el [fecha]"
  - CASO 2: Con m√©todo de pago + trial activo ‚Üí Sin mensaje de advertencia (limpio)
  - CASO 3: Sin m√©todo de pago + elimin√≥ durante trial ‚Üí Mismo mensaje "per√≠odo de prueba terminar√°"  
  - CASO 4: Sin m√©todo de pago + suscripci√≥n activa ‚Üí "Tu suscripci√≥n no se renovar√° el [fecha]"
  - Sistema condicional que detecta autom√°ticamente el estado exacto del usuario
  - Mensajes contextuales precisos que gu√≠an al usuario seg√∫n su situaci√≥n espec√≠fica
  - Terminolog√≠a clara diferenciando "per√≠odo de prueba" vs "suscripci√≥n activa"
- June 28, 2025. MENSAJES DE TRIAL CORREGIDOS COMPLETAMENTE: Terminolog√≠a clara indicando per√≠odo de prueba
  - TrialManager (dashboard): Solo aparece sin m√©todo de pago, dice "Per√≠odo de Prueba [Plan]" con mensajes claros
  - TrialManagerSimple (configuraci√≥n): Siempre muestra estado, diferencia sin/con m√©todo de pago
  - Sin pago: "Per√≠odo de prueba hasta el [fecha] ‚Ä¢ ‚Ç¨X/mes despu√©s"
  - Con pago: "Per√≠odo de prueba activo. Se cobrar√° el [fecha] ‚Ä¢ ‚Ç¨X/mes"
  - T√≠tulos corregidos de "Plan Pro" a "Per√≠odo de Prueba Pro" para m√°xima claridad
  - Secci√≥n m√©todos de pago: "Tu per√≠odo de prueba terminar√°" en lugar de "Tu suscripci√≥n terminar√°"
  - Todos los mensajes ahora indican expl√≠citamente que est√°n en per√≠odo de prueba
- June 28, 2025. SISTEMA DE LOGIN TESTING COMPLETAMENTE IMPLEMENTADO: Tests exhaustivos para autenticaci√≥n m√∫ltiple
  - 27 tests de login implementados y TODOS PASANDO exitosamente (27/27) en loginSystem.test.ts
  - Tests de autenticaci√≥n m√∫ltiple: DNI, NIE, correo personal y correo corporativo funcionando
  - Encriptaci√≥n segura validada: bcrypt con 10+ rounds, verificaci√≥n y hashes √∫nicos
  - Funcionalidad "Recordarme" completamente testeada: guardado, carga, eliminaci√≥n y manejo de errores
  - Tests de normalizaci√≥n: emails a min√∫sculas, DNI/NIE a may√∫sculas, eliminaci√≥n de espacios
  - Seguridad verificada: rate limiting, no exposici√≥n de contrase√±as, validaci√≥n por empresa
  - Gesti√≥n de tokens JWT: generaci√≥n correcta y persistencia en localStorage
  - Sistema robusto que garantiza funcionamiento correcto de todas las formas de login
  - Tests protegidos con comentarios ‚ö†Ô∏è PROTECTED para prevenir regresiones futuras
- June 28, 2025. SISTEMA DE TESTING VITEST IMPLEMENTADO COMPLETAMENTE: Protecci√≥n cr√≠tica de funciones clave
  - Vitest configurado e instalado como framework de testing para Oficaz
  - Tests completos para calculateDays(): 14 casos que cubren fechas b√°sicas, fines de semana, cambios de mes, a√±os bisiestos
  - Tests exhaustivos para analyzeFileName(): 23 casos cubriendo detecci√≥n de empleados, tipos de documento, niveles de confianza
  - Utilidades compartidas creadas: dateUtils.ts y documentUtils.ts con funciones protegidas usando comentarios ‚ö†Ô∏è PROTECTED
  - Configuraci√≥n completa con vitest.config.ts, tests/setup.ts, mocks de localStorage y fetch
  - Todos los tests pasan exitosamente (64/64): sistema robusto que previene regresiones futuras
  - Funciones cr√≠ticas blindadas contra cambios futuros que puedan romper funcionalidades clave
  - Sistema preparado para a√±adir tests de m√°s funciones cr√≠ticas (generatePDF, calculateTotal, formatTime)
- June 28, 2025. REORGANIZACI√ìN DE PESTA√ëAS VACACIONES COMPLETADA: Timeline ahora es pesta√±a principal
  - "Timeline de Vacaciones" reubicado como primera pesta√±a con nombre m√°s descriptivo
  - Pesta√±a por defecto cambiada de "Solicitudes" a "Timeline de Vacaciones" 
  - Texto m√≥vil actualizado: "Timeline" para pantallas peque√±as
  - Orden final: Timeline de Vacaciones ‚Üí Solicitudes ‚Üí D√≠as Festivos
  - Sistema Gantt con barras correctamente posicionadas ahora es la vista principal
- June 28, 2025. BUG CR√çTICO BARRAS VACACIONES POSICIONAMIENTO RESUELTO: Timeline Gantt completamente funcional
  - PROBLEMA CR√çTICO: Barras de vacaciones aparec√≠an fuera de l√≠neas horizontales en timeline
  - SOLUCI√ìN: Contenedor espec√≠fico con absolute inset-0 overflow-hidden para barras
  - Altura barras reducida (h-10) vs contenedor (h-12) para margen interno adecuado  
  - Posicionamiento centrado: top:4px y bottom:4px para alineaci√≥n perfecta
  - Eliminado overflow-hidden problem√°tico del contenedor principal
  - Sistema Gantt ahora muestra barras perfectamente contenidas dentro de sus l√≠neas
  - Funcionalidad completa: tooltips, c√°lculo din√°mico d√≠as, botones revertir operativos
- June 28, 2025. BUG CR√çTICO PDF CORREGIDO: C√°lculos de horas y formato de descansos completamente arreglados
  - PROBLEMA 1 RESUELTO: C√°lculo de horas totales ahora descuenta correctamente los per√≠odos de descanso
  - PROBLEMA 2 RESUELTO: M√∫ltiples descansos ahora aparecen con saltos de l√≠nea (\n\n) en lugar de comas
  - PROBLEMA 3 RESUELTO: Formato mejorado con separador de barras verticales para evitar solapamiento
  - Actualizada funci√≥n formatBreakPeriodsForPDF para usar ' | ' como separador sin interferir con layout PDF
  - Corregida l√≥gica de c√°lculo: sessionHours - breakHours = horas reales trabajadas
  - Sistema ahora calcula: tiempo total (entrada-salida) menos tiempo total de descansos
  - PDFs muestran horas exactas trabajadas y descansos legibles con formato vertical espaciado
- June 28, 2025. BOTONES DE FICHAJE ADMIN ESTANDARIZADOS: Tama√±os uniformes y debugging a√±adido
  - Todos los botones (Entrar, Salir, Descanso, Fin Descanso) estandarizados a w-[120px] h-[48px]
  - Logs de debugging a√±adidos a mutations de clock-in y clock-out para identificar errores espec√≠ficos
  - Errores de Stripe en logs del servidor identificados como NO relacionados con sistema de fichaje
  - Sistema de fichaje admin mantiene funcionalidad id√©ntica a empleado con mensajes din√°micos
- June 28, 2025. DATOS DE EMPRESA A STRIPE CORREGIDOS: Informaci√≥n completa y fechas de cobro sincronizadas
  - Endpoint `/api/account/confirm-payment-method` corregido para enviar datos COMPLETOS de empresa a Stripe
  - Customer de Stripe ahora incluye: nombre empresa, direcci√≥n completa, CIF, email, datos contacto
  - Fechas de cobro en Stripe perfectamente sincronizadas con "Pr√≥ximo cobro" mostrado en app
  - Trial periods respetan fecha exacta: `trial_end` en Stripe = `trial_end_date` de base datos
  - Pagos tard√≠os procesan inmediatamente pero mantienen alignment con pr√≥ximas fechas
  - Facturaci√≥n garantizada: Stripe tiene toda informaci√≥n necesaria para facturas precisas
  - Sistema cr√≠tico para cumplimiento legal: CIF, direcciones, datos fiscales correctos
  - Eliminada tarjeta verde "Suscripci√≥n Activa" de TrialManagerSimple.tsx para interfaz m√°s limpia
  - Agregado mensaje discreto de cancelaci√≥n programada en dashboard admin para usuarios sin m√©todo de pago
  - Corregido formateo de fecha en mensaje de cancelaci√≥n usando nextPaymentDate del endpoint
- June 28, 2025. L√ìGICA DE FACTURAS OPTIMIZADA: Secci√≥n solo visible con m√©todo de pago configurado
  - Sin m√©todo de pago ‚Üí secci√≥n de facturas completamente oculta
  - Con m√©todo de pago ‚Üí secci√≥n visible con facturas reales de Stripe o mensaje "a√∫n no hay facturas"
  - Eliminados badges de "Demostraci√≥n" y referencias a datos sint√©ticos del frontend
  - Sistema completamente limpio: solo muestra datos aut√©nticos cuando hay configuraci√≥n real
- June 28, 2025. BUG CR√çTICO CORREGIDO: stripe_customer_id ahora se busca en tabla users correctamente
  - Corregida consulta SQL para buscar stripe_customer_id en tabla `users` en lugar de `subscriptions`
  - Sistema de facturas ahora funciona correctamente con la estructura real de base de datos
  - Endpoint /api/account/invoices corregido para obtener customer ID del usuario admin de la empresa
  - Eliminados logs de debugging para versi√≥n de producci√≥n limpia
- June 28, 2025. HISTORIAL DE FACTURAS MIGRADO A STRIPE API: Sistema completamente integrado con datos reales
  - Reemplazado sistema de facturas sint√©ticas por integraci√≥n directa con Stripe invoices API
  - Endpoint `/api/account/invoices` ahora consulta facturas reales de Stripe usando customer ID
  - Conversi√≥n autom√°tica de centavos a euros y formateo de fechas desde timestamps Unix
  - Bot√≥n de descarga PDF agregado cuando Stripe proporciona invoice_pdf URL
  - Sistema robusto: retorna array vac√≠o en lugar de error cuando no hay Stripe customer ID
  - Solo muestra facturas pagadas (status: 'paid') para mejor experiencia de usuario
  - Datos completamente aut√©nticos: n√∫meros de factura, importes, fechas y descripciones reales
  - Eliminados todos los datos sint√©ticos hardcodeados del sistema de facturaci√≥n
- June 28, 2025. MENSAJES DE AUTO-CANCELACI√ìN OPTIMIZADOS: Terminolog√≠a precisa implementada
  - Mejorados mensajes de advertencia para mostrar fecha exacta de cancelaci√≥n de forma prominente
  - Mensaje principal corregido: "‚ö†Ô∏è Tu suscripci√≥n terminar√° el [fecha]" en lugar de "pr√≥ximo pago"
  - Terminolog√≠a precisa sin tarjeta: "terminar√°" y "se cancelar√°" en lugar de referencias a pagos
  - Ambas secciones actualizadas: tarjeta de estado de suscripci√≥n y secci√≥n de m√©todos de pago
  - Texto m√°s directo y accionable: "A√±ade una tarjeta antes de esa fecha para mantener tu suscripci√≥n"
  - Sistema completo: detecci√≥n autom√°tica ‚Üí programaci√≥n cancelaci√≥n ‚Üí warning claro con fecha espec√≠fica
  - Formateo de fecha en espa√±ol: "3 de agosto de 2025" usando formatDate con locale es-ES
  - Key √∫nico agregado para forzar re-render del componente en actualizaciones
  - L√≥gica condicional mejorada: "Pr√≥ximo cobro" solo aparece con m√©todos de pago activos
  - Posicionamiento optimizado: mensaje de cancelaci√≥n aparece exactamente donde aparecer√≠a "Pr√≥ximo cobro"
- June 28, 2025. L√ìGICA DE PAGOS OPTIMIZADA Y FINALIZADA: Sistema completo de fechas de primer y pr√≥ximo pago
  - Campo firstPaymentDate a√±adido al esquema de suscripciones para manejar fecha del primer cobro
  - L√≥gica empresarial correcta implementada: pago antes del trial ‚Üí primer cobro al terminar trial
  - Pago despu√©s del trial ‚Üí primer cobro inmediato al a√±adir m√©todo de pago
  - Mensajes personalizados seg√∫n escenario: "primer cobro el [fecha]" o "primer cobro procesado hoy"
  - Base de datos migrada exitosamente con nuevo campo first_payment_date
  - Endpoint confirm-payment-method actualizado para calcular ambas fechas independientemente
  - Sistema robusto que maneja correctamente los dos escenarios de timing de pago
- June 28, 2025. CONCEPTOS DE FECHAS CLARIFICADOS: Trial end vs Next payment date separados
  - Documentada diferencia cr√≠tica entre trial_end_date (bloqueo) y next_payment_date (cobro)
  - Sistema preparado para manejar pagos tard√≠os donde las fechas no coinciden
  - L√≥gica actual calcula correctamente pr√≥ximo cobro basado en fin de trial + tiempo transcurrido
- June 28, 2025. TARJETA DE TRIAL OCULTA AL ACTIVAR SUSCRIPCI√ìN: UX mejorada tras confirmaci√≥n de pago
  - TrialManager.tsx modificado para retornar null cuando status='active' y trial inactivo
  - Eliminada tarjeta verde "Suscripci√≥n Activa" que aparec√≠a tras confirmar pago
  - Interfaz m√°s limpia: solo muestra notificaciones cuando hay acciones pendientes (trial o cuenta bloqueada)
  - Sistema de invalidaci√≥n de cache implementado para refrescar estado tras pago exitoso
  - Etiquetas de estado traducidas al espa√±ol: ACTIVO, PRUEBA, CANCELADO
- June 28, 2025. FLUJO DE PAGO TRIAL SIMPLIFICADO: Sistema optimizado para gesti√≥n de m√©todos de pago
  - TrialManagerSimple.tsx creado para enfoque espec√≠fico en a√±adir m√©todos de pago durante trial
  - Componente simplificado sin funcionalidades de pago directo, solo gesti√≥n de tarjetas
  - Eliminadas secciones de trial expirado y cuenta bloqueada del componente original
  - Modal Dialog integrado con PaymentMethodManager para flujo de gesti√≥n de pagos
  - settings.tsx actualizada para usar TrialManagerSimple en lugar de TrialManager
  - Base de datos actualizada a status='trial' para permitir testing del flujo de trial
  - Sistema enfocado en a√±adir m√©todo de pago sin procesar pago inmediato
- June 27, 2025. AVISO DE TRIAL REDISE√ëADO: Notificaci√≥n discreta y menos invasiva implementada
  - Eliminada tarjeta grande y colores llamativos por dise√±o compacto horizontal
  - Fondos suaves con transparencias (amber-50/50, blue-50/30) en lugar de colores s√≥lidos
  - Tipograf√≠a reducida: text-xs y text-sm para informaci√≥n esencial √∫nicamente
  - Bot√≥n minimalista "A√±adir pago" tipo ghost en lugar de botones grandes prominentes
  - Mensaje enfocado: "a√±adir m√©todo de pago" sin selecci√≥n de plan (ya est√° elegido)
  - Iconos peque√±os en c√≠rculos sutiles, informaci√≥n contextual seg√∫n d√≠as restantes
  - Dise√±o discreto que no interrumpe el flujo de trabajo del usuario
- June 27, 2025. FECHAS DE TRIAL SINCRONIZADAS CON REGISTRO REAL: Inconsistencia cr√≠tica corregida
  - PROBLEMA RESUELTO: Trial iniciaba 3 d√≠as antes del registro de empresa (16 jun vs 19 jun)
  - Base de datos corregida: trial_start_date ahora coincide con company.created_at (19 junio 2025)
  - Trial period recalculado: 19 junio ‚Üí 3 julio 2025 (exactamente 14 d√≠as desde registro real)
  - Sistema completamente sincronizado: empresa registrada y trial iniciado el mismo d√≠a
  - PaymentMethodManager implementado: interfaz completa para gesti√≥n de tarjetas con Stripe
  - Preparado para integraci√≥n real de Stripe pendiente de claves API del usuario
- June 27, 2025. TRIAL MANAGER ACTUALIZADO: Precios din√°micos desde configuraci√≥n super admin implementados
  - Eliminados precios hardcodeados (‚Ç¨3/‚Ç¨5/‚Ç¨8) en selector de planes de TrialManager
  - A√±adido endpoint p√∫blico /api/subscription-plans para usuarios autenticados
  - Query hook actualizada para usar datos reales de base de datos subscription_plans
  - SelectItems ahora muestran displayName y pricePerUser din√°micos (ej: "Plan Basic - ‚Ç¨29.99/mes")
  - Funci√≥n getPlanPrice() implementada para obtener precios espec√≠ficos de cada plan
  - Sistema completamente integrado con configuraci√≥n del super admin
- June 27, 2025. DATE PICKER COMPLETAMENTE REDISE√ëADO: Sistema operativo eficiente implementado exitosamente
  - Componente DatePickerDay redise√±ado con selecci√≥n independiente a√±o/mes/d√≠a para m√°xima eficiencia operativa
  - Eliminada navegaci√≥n "pegajosa" mes a mes: ahora permite salto directo a cualquier fecha (ej: 5 a√±os atr√°s)
  - Selectores independientes: A√±o (80 a√±os hacia atr√°s), Mes (nombres en espa√±ol), D√≠a (adapta autom√°ticamente)
  - L√≥gica inteligente: ajuste autom√°tico d√≠a al cambiar mes (ej: 31 Feb ‚Üí 28/29 Feb)
  - Backend corregido: conversi√≥n Date‚ÜíISO string en funciones handleCreateEmployee y handleSaveEmployee
  - Sistema robusto: conserva funcionalidad existente mientras mejora dram√°ticamente la experiencia operativa
  - Cumple requerimiento cr√≠tico del usuario: "por dios no rompas nada" - todas las funciones previas intactas
- June 27, 2025. SISTEMA DE L√çMITES DE USUARIOS COMPLETAMENTE IMPLEMENTADO
  - Tarjeta de usuarios en configuraci√≥n ahora muestra formato "X/Y" (usuarios actuales/l√≠mite m√°ximo)
  - Validaci√≥n de l√≠mite de usuarios implementada en creaci√≥n de empleados
  - Mensaje de error espec√≠fico cuando se intenta exceder el l√≠mite configurado en el plan
  - Sistema respeta l√≠mites configurados por super admin (ej: 50 usuarios para plan Pro)
- June 27, 2025. MODELO DE PRECIOS CAMBIADO A PRECIO FIJO MENSUAL: Ya no es por usuario
  - Actualizada interfaz super admin: "‚Ç¨ fijo/mes" en lugar de "‚Ç¨/mes" 
  - Schema comentado: pricePerUser ahora es precio fijo mensual (ej: 29.99 euros/mes)
  - Eliminado concepto de precio por usuario: ahora es precio fijo independiente del n√∫mero de usuarios
  - Sistema de facturaci√≥n simplificado: planes con precio mensual fijo sin multiplicadores
- June 27, 2025. SISTEMA DE TRIAL COMPLETAMENTE CORREGIDO: Ahora respeta tabla de super admin
  - Eliminado sistema hardcodeado de funcionalidades por trial que ignoraba configuraci√≥n de super admin
  - Trial Basic y Pro ahora usan EXACTAMENTE las funcionalidades configuradas en tabla de super admin
  - Sistema unificado: checkFeatureAccess() consulta subscription.features[feature] para trial y activo
  - Trial ahora es SOLO limitaci√≥n temporal (14 d√≠as), funcionalidades vienen de base de datos
  - Bot√≥n configuraci√≥n funcional para ambos planes seg√∫n configuraci√≥n de super admin
  - Plan "free" eliminado del sistema ‚Üí ahora empresas muestran "Basic" por defecto
- June 27, 2025. Banner de cookies optimizado para usuarios autenticados
  - Banner de cookies ya no aparece para usuarios logueados
  - Solo se muestra a visitantes no autenticados seg√∫n normativa RGPD
  - Mejora la experiencia de usuario eliminando interrupciones innecesarias
- June 27, 2025. Tarjeta de visita empresarial implementada en dashboard empleado
  - Modal profesional que aparece al hacer clic en logo/nombre de empresa
  - Informaci√≥n corporativa completa: nombre empresa, CIF, direcci√≥n postal completa
  - Dise√±o minimalista y moderno con bordes redondeados (rounded-3xl)
  - Efecto glassmorphism elegante con backdrop-blur y transparencias
  - Iconos m√°s peque√±os y sutiles con contenedores rounded-xl
  - Tipograf√≠a refinada y espaciado compacto para look profesional
  - Responsive y accesible, solo muestra campos con datos reales
- June 27, 2025. Chat empleado completamente funcional en desktop y m√≥vil - PROBLEMA CR√çTICO RESUELTO
  - CORREGIDO: Chat empleado ahora visible en ambas versiones (desktop Y m√≥vil)
  - Eliminada clase lg:hidden que ocultaba el chat empleado en pantallas grandes
  - Visibilidad del chat en versi√≥n m√≥vil mejorada con fondo degradado #1A2332 a #0F1419
  - Auto-scroll optimizado con selector espec√≠fico para contenedor m√≥vil empleado
  - B√∫squeda inteligente de contenedor scrollable dentro de vista m√≥vil oscura
  - M√∫ltiples intentos de scroll (100ms, 300ms, 600ms) para asegurar funcionamiento
  - Sistema PROTEGIDO con comentarios ‚ö†Ô∏è DO NOT MODIFY para prevenir regresiones futuras
  - Chat empleado ahora funciona perfectamente en todas las resoluciones de pantalla
- June 27, 2025. Optimizaci√≥n cr√≠tica de rendimiento completada - polling reducido significativamente
  - Employee Dashboard: intervals de polling aumentados de 3-15s a 10-120s en todas las queries  
  - Work sessions activas: 3s ‚Üí 10s para balance entre tiempo real y rendimiento
  - Break periods: 3s ‚Üí 15s solo cuando hay sesi√≥n activa, deshabilitado en background
  - Messages: 10s ‚Üí 30s con cache de 25s y sin polling en background
  - Documents/notifications: 15s ‚Üí 60s con cache de 45s para reducir carga servidor
  - Vacation requests: 10s ‚Üí 120s con cache de 90s ya que cambian poco frecuentemente
  - Employee Time Tracking: work sessions/breaks de 3s ‚Üí 15s, active session 3s ‚Üí 10s
  - Background polling completamente deshabilitado en todas las queries para mayor eficiencia
  - Stale time incrementado en todas las queries para mejor caching y menos requests
  - Resultado: reducci√≥n masiva de carga servidor manteniendo experiencia usuario aceptable
- June 27, 2025. Corregido problema de redirecci√≥n en recarga de p√°gina
  - Ruta ra√≠z "/" ahora usa componente PublicRoute para verificar autenticaci√≥n
  - Usuarios logueados son redirigidos autom√°ticamente al dashboard correspondiente
  - Ya no aparece landing page cuando usuario est√° autenticado tras recargar
  - Comportamiento correcto: admin ‚Üí dashboard admin, empleado ‚Üí dashboard empleado
- June 27, 2025. Sistema de protecci√≥n EXPANDIDO: Funciones cr√≠ticas de time tracking completamente blindadas
  - Extendida protecci√≥n a funciones de c√°lculo estad√≠stico: calculateTotal(), getLastFourMonths()
  - Blindada funci√≥n generatePDF() en admin time tracking para informes de control horario
  - Protegida funci√≥n formatTime() que formatea hora espa√±ola en empleado time tracking
  - Blindada funci√≥n renderMobileTimeline() CR√çTICA para visualizaci√≥n timeline m√≥vil
  - Sistema de protecci√≥n sistem√°tico aplicado con comentarios ‚ö†Ô∏è PROTECTED y DO NOT MODIFY
  - Prevenci√≥n completa de regresiones en funcionalidades clave de fichajes y visualizaci√≥n
  - Todas las funciones cr√≠ticas ahora resistentes a cambios futuros que puedan romper el sistema
- June 27, 2025. Sistema de clasificaci√≥n de documentos BLINDADO contra regresiones
  - Funci√≥n analyzeFileName protegida con comentarios ‚ö†Ô∏è PROTECTED y advertencias "DO NOT MODIFY"
  - Eliminados logs de debugging que causaban confusi√≥n en producci√≥n
  - Documentaci√≥n de est√°ndares de protecci√≥n de c√≥digo cr√≠tico en User Preferences
  - Sistema resistente a cambios futuros que puedan romper la clasificaci√≥n autom√°tica
  - Patr√≥n de protecci√≥n implementado para funcionalidades cr√≠ticas del sistema
- June 27, 2025. Headers empleado estandarizados completamente siguiendo patr√≥n de fichajes
  - Documentos, recordatorios y mensajes empleado ahora usan header est√°ndar id√©ntico
  - Logo inteligente: se muestra solo si tiene logo Y funci√≥n logoUpload habilitada por super admin
  - Filtro brightness-0 invert aplicado a logos para visibilidad en fondos oscuros
  - Comentarios "Standard employee pattern" y "Page title" a√±adidos para consistencia
  - Headers ahora siguen exactamente el mismo formato que employee-time-tracking.tsx
  - Eliminados headers inconsistentes con dise√±os personalizados diferentes
- June 27, 2025. Gr√°ficas animadas al cargar p√°gina implementadas en timeline empleado
  - Barras de gr√°ficas suben desde 0 hasta altura final con animaci√≥n growHeight
  - Duraci√≥n 1.2s ease-out con delays escalonados de 150ms entre barras
  - Tarjetas aparecen con fadeInUp y opacity inicial 0 para entrada suave
  - Animaci√≥n CSS growHeight usando variable --final-height para altura din√°mica
  - Delays: tarjetas (index * 100ms), barras (index * 150ms + 300ms) para secuencia visual
- June 27, 2025. Tarjeta de vacaciones redise√±ada con colores de gr√°ficas de fichajes
  - Total: text-blue-400 (azul vibrante como barras principales de fichajes)
  - Aprobados: text-orange-400 (naranja como barras de descanso en timeline)
  - Disponibles: text-green-400 (verde como puntos de entrada en timeline)
  - Barra de progreso: bg-blue-500 s√≥lido (mismo azul que barras de trabajo)
  - Leyenda "d√≠as disponibles": text-green-400/70 para consistencia visual
  - Fondo: bg-white/10 backdrop-blur-sm rounded-xl border-white/20 (id√©ntico a gr√°ficas)
  - Esquema de colores y fondo ahora coincide perfectamente con las gr√°ficas de horas
- June 27, 2025. URL empleado simplificada: /fichajes-empleado ‚Üí /misfichajes
  - Cambio de URL m√°s amigable y corta para empleados
  - URL anterior /fichajes-empleado cambiada a /misfichajes
  - Actualizado en routing App.tsx y redirecci√≥n de seguridad 
  - Dashboard empleado actualizado con nueva ruta en menuItems
- June 27, 2025. SEGURIDAD CR√çTICA: Protecci√≥n de rutas de fichajes por roles implementada
  - Ruta /fichajes ahora requiere rol admin/manager obligatoriamente
  - Empleados son redirigidos autom√°ticamente a /misfichajes
  - Imposible saltarse seguridad cambiando URL manualmente
  - Verificaci√≥n de roles aplicada en routing de App.tsx
  - Sistema de redirecci√≥n autom√°tica usando Redirect de wouter
- June 27, 2025. Timeline de empleado optimizado con tarjetas compactas y alineaci√≥n perfecta
  - Altura de tarjetas reducida: padding de p-3 a p-2 para dise√±o m√°s compacto
  - Header ajustado: margen inferior de mb-4 a mb-3 en fecha y horas totales
  - Timeline m√°s compacto: altura reducida de h-7 a h-6 en contenedor de barras
  - Alineaci√≥n corregida: header con mx-2 para coincidir exactamente con l√≠mites de barra azul
  - Espaciado mejorado: mb-4 en timeline para evitar solapamiento con puntos entrada/salida
  - Cambios aplicados uniformemente en sesiones individuales y d√≠as m√∫ltiples
  - Dise√±o final m√°s limpio con textos perfectamente alineados a l√≠mites de barra temporal
- June 27, 2025. Timeline de empleado finalizado con barras ancho completo y UI optimizada
  - Barras de timeline redise√±adas para ocupar todo el ancho del contenedor (no proporcional)
  - Puntos de entrada (verde) y salida (rojo) s√≥lidos en extremos izquierdo y derecho de barras
  - Sesiones individuales y m√∫ltiples usan ancho completo sin c√°lculos proporcionales basados en horas
  - Barras de descanso posicionadas correctamente dentro de barras de ancho completo
  - Tarjetas completas clickeables para expandir/contraer, no solo las barras de timeline
  - Texto "Descansos:" solo visible cuando el contenedor est√° expandido para vista limpia
  - Componente de debug eliminado completamente para c√≥digo de producci√≥n
  - Funcionalidad expandir/contraer operativa tanto para sesiones individuales como m√∫ltiples
  - Sistema visual mejorado con jerarqu√≠a clara entre elementos expandidos y contra√≠dos
  - Eliminadas etiquetas "Entrada:" y "Salida:" - solo hora en color verde (entrada) y rojo (salida)
  - Formato simplificado aplicado tanto en sesiones individuales como jornadas partidas
  - OPTIMIZADO: Contenedores m√°s compactos (p-3 mb-2 en lugar de p-4 mb-3)
  - OPTIMIZADO: Eliminado icono gr√°fico üìä del total semanal para dise√±o m√°s limpio
  - OPTIMIZADO: Navegaci√≥n al futuro bloqueada - usuarios no pueden ir a meses posteriores
  - MEJORADO: Sesiones m√∫ltiples del mismo d√≠a ahora se muestran en l√≠nea horizontal
  - MEJORADO: Cada sesi√≥n ocupa su porci√≥n proporcional del ancho disponible
  - MEJORADO: Puntos entrada/salida y barras de descanso ajustados para layout horizontal
- June 27, 2025. Timeline de empleado completamente redise√±ado con estilo admin y puntos de entrada/salida
  - Barras de timeline h-5 (principal) y h-4 (descansos) igual que vista admin para consistencia visual
  - Puntos de entrada verdes y salida rojos con borde blanco y sombras para mejor visibilidad
  - Posicionamiento preciso: entrada alineada con inicio de barra, salida ligeramente a la derecha
  - Barras expandidas para ocupar m√°s ancho del contenedor (¬±2% expansi√≥n)
  - Distancia reducida entre timeline y etiquetas de horas para mejor compactaci√≥n
  - Soporte completo para m√∫ltiples sesiones por d√≠a con bloques separados
  - Agrupaci√≥n inteligente por d√≠a: sesi√≥n √∫nica usa renderizado individual, m√∫ltiples sesiones agrupadas
  - Sistema de tooltips funcional para per√≠odos de descanso con hover
  - Mantiene dise√±o mobile-first con jerarqu√≠a visual mejorada
- June 27, 2025. Sistema h√≠brido de posicionamiento horizontal implementado completamente
  - Algoritmo que detecta colisiones entre puntos y los desplaza horizontalmente
  - Desplazamiento horizontal sutil: entradas 1% izquierda, salidas 1% derecha
  - Todos los puntos mantienen alineaci√≥n vertical con la barra azul (top: 0px)
  - Sistema inteligente: zonas sin colisi√≥n mantienen alineaci√≥n + horas visibles
  - Zonas con colisi√≥n usan puntos desplazados + tooltips √∫nicamente
  - Puntos con bordes blancos y sombras para mejor visibilidad
  - Sistema funcional que evita solapamientos manteniendo l√≠nea horizontal consistente
- June 27, 2025. Algoritmo de detecci√≥n de proximidad en timeline corregido definitivamente
  - Umbral ajustado de 3 a 0 para m√°xima sensibilidad a la proximidad de puntos
  - Ahora cuando los puntos de entrada/salida est√°n cerca, se ocultan las horas autom√°ticamente
  - Sistema funciona correctamente: muestra solo puntos con tooltips hover cuando hay proximidad
  - Logs de depuraci√≥n eliminados tras confirmar funcionamiento correcto del algoritmo
  - Comportamiento: cualquier proximidad detectada activa modo compacto (dots + hover)
- June 27, 2025. Sistema de tooltips para descansos implementado completamente
  - Tooltips din√°micos para descansos activos y completados en l√≠nea de tiempo de fichajes
  - Descansos activos: "Descanso en progreso: X min" con posicionamiento inteligente
  - Descansos completados: "Descanso: HH:MM - HH:MM (X min)" con duraci√≥n y horarios
  - Sistema de tooltip personalizable con tooltipContent state y eventos mouse optimizados
  - Eventos onMouseEnter/onMouseLeave para mostrar/ocultar tooltips con limpieza de estado
  - Posicionamiento autom√°tico centrado sobre barras con flecha indicadora inferior
  - Compatible tanto con barras grises (completados) como naranjas pulsantes (activos)
- June 27, 2025. Sistema de mensajes din√°micos integrado en caj√≥n de fichaje y toasts eliminados
  - Toasts de fichaje completamente eliminados y reemplazados por mensajes integrados
  - L√≠nea de estado con colores distintivos: "üü¢ Trabajando..." (verde) o "üî¥ Fuera del trabajo" (rojo)
  - Estado visual inmediato usando text-green-400 para activo y text-red-400 para inactivo
  - Mensajes din√°micos seg√∫n hora: "Buenos d√≠as/tardes/noches, Entrada/Salida registrada"
  - Sistema temporal: mensaje visible 3 segundos en "Tu √∫ltimo fichaje", luego vuelve al estado normal
  - Indicador visual: "‚úì Fichaje exitoso" con texto verde cuando hay mensaje temporal
  - L√≥gica de saludos: 6-14h Buenos d√≠as, 14-20h Buenas tardes, resto Buenas noches
  - Funciones generateDynamicMessage() y showTemporaryMessage() para gesti√≥n de mensajes
  - Experiencia m√°s fluida sin popups molestos, feedback directo en interfaz existente
- June 27, 2025. Dashboard de empleado optimizado con bot√≥n de fichar m√°s grande y colores corporativos
  - Bot√≥n de fichar incrementado a 32x32 (w-32 h-32) con texto text-xl para mejor visibilidad
  - Iconos del men√∫ cambiados de blanco a color corporativo #007AFF para coherencia visual
  - Logo empresa aumentado a h-10, nombre text-base para mayor prominencia sin "caj√≥n"
  - Loading spinner del bot√≥n fichar aumentado a w-12 h-12 para mejor visibilidad
  - Header compacto: avatar 8x8, nombre text-xs, bot√≥n salir reducido
  - Contenedor principal usa h-screen sin overflow-y-auto para ajuste perfecto
  - Informaci√≥n de fichaje compacta: rounded-lg p-2, texto text-xs y text-sm
  - Espaciado m√≠nimo: mb-2 entre secciones, gap-2 en grid de men√∫
  - Layout usando flex flex-col con p-4 para aprovechar toda la ventana
  - Garantizado que todo el contenido sea visible sin hacer scroll en m√≥viles
  - Dise√±o profesional con colores corporativos #007AFF completamente consistentes
- June 27, 2025. Dashboard de empleado completamente redise√±ado con est√©tica moderna y elegante
  - Iconos de funcionalidades ampliados y con efectos glassmorphism inspirados en el hero de landing
  - Botones de men√∫ con gradientes, backdrop-blur, efectos hover scale y animaciones de pulso
  - Notificaciones mejoradas con gradientes y efectos bounce m√°s llamativos
  - Header de usuario modernizado con avatar circular de iniciales y bot√≥n salir elegante
  - Logo/nombre de empresa en contenedor glassmorphism con sombras y bordes sutiles
  - Informaci√≥n de √∫ltimo fichaje en tarjeta moderna con backdrop-blur y bordes transl√∫cidos
  - Bot√≥n principal de fichar redise√±ado: gradiente tricolor, efectos de brillo animados, part√≠culas flotantes
  - Anillo pulsante verde cuando hay sesi√≥n activa, transiciones suaves y escalado hover
  - Mensaje de vacaciones mejorado con gradiente emerald-teal-cyan y efectos de profundidad
  - Todos los elementos mantienen funcionalidad completa sin cambios en l√≥gica o navegaci√≥n
- June 27, 2025. Sistema de gesti√≥n de invitaciones para super admin implementado completamente
  - Nueva p√°gina super-admin-invitations.tsx con dise√±o moderno espectacular y glassmorphism
  - Gesti√≥n completa de configuraci√≥n de registro: p√∫blico vs solo por invitaci√≥n
  - Sistema de creaci√≥n y gesti√≥n de enlaces de invitaci√≥n con expiraci√≥n de 7 d√≠as
  - Integraci√≥n en dashboard super admin con bot√≥n prominente "Invitaciones"
  - Estad√≠sticas visuales: invitaciones activas, utilizadas, expiradas y total
  - Funcionalidades: crear, copiar enlace, eliminar invitaciones con confirmaci√≥n
  - Modal avanzado para crear invitaciones con email, invitador y empresa opcional
  - Sistema de badges de estado (activa/utilizada/expirada) con colores diferenciados
  - Interfaz responsive con efectos hover, transiciones suaves y tema oscuro
  - Routing completo configurado en App.tsx para /super-admin/invitations
- June 27, 2025. Logos de Oficaz corregidos en todas las p√°ginas legales
  - Reemplazados logos improvisados (icono cookie, letra "O") por logo real de Oficaz
  - Pol√≠tica de Cookies, Privacidad y T√©rminos ahora muestran imagotipo oficial
  - Logo con altura h-10 y ancho autom√°tico para proporciones correctas
  - Importaci√≥n consistente desde '@assets/Imagotipo Oficaz_1750321812493.png'
- June 27, 2025. Navegaci√≥n del header optimizada con anclas en espa√±ol
  - Anclas cambiadas a espa√±ol: #funciones y #precios en lugar de #features y #pricing
  - Eliminada ancla #testimonials del header ya que la secci√≥n fue removida
  - IDs de secciones actualizados para coincidir con anclas espa√±olas
  - Fondo header completamente blanco s√≥lido para m√°xima visibilidad sobre secciones oscuras
  - Shadow-xl y border m√°s fuerte para contraste sobre hero negro
  - Navegaci√≥n m√°s limpia con solo dos enlaces principales: Funciones y Precios
- June 27, 2025. Hero section responsive corregido para pantallas PC estrechas
  - Cambiada altura fija por minHeight responsive con padding adaptativo
  - Textos y espaciado optimizados: tama√±os escalables, espaciado reducido en m√≥vil
  - Contenedor reducido a max-w-4xl para mejor lectura en pantallas estrechas
  - Indicadores de confianza adaptados: layout vertical en m√≥vil, horizontal en desktop
  - Descripci√≥n actualizada: enfoque en horas perdidas en tareas espec√≠ficas (env√≠o archivos, control horarios manual)
  - Nueva frase final: "automatiza lo tedioso para que te enfoques en lo importante"
- June 26, 2025. Landing page final optimizada con CTA espectacular y estructura limpia
  - Eliminada secci√≥n completa de testimonios por preferencia del usuario
  - Secci√≥n CTA final ampliada y mejorada: gradiente triple azul, efectos blur, elementos flotantes
  - T√≠tulo impactante "Transforma tu empresa en minutos" con gradiente cian-blanco-azul
  - Grid de beneficios: Configuraci√≥n Instant√°nea, Equipo Productivo, Crecimiento Real
  - Descripci√≥n emocional enfocada en problemas reales: papeles perdidos, horas extras, procesos complicados
  - Bot√≥n CTA √∫nico "Empezar Gratis Ahora" con efectos hover y sin bot√≥n ventas
  - Indicadores de confianza: datos seguros, 15 d√≠as gratis, sin tarjeta requerida
  - Dise√±o moderno con badges, animaciones pulse y efectos hover avanzados
- June 26, 2025. Banner de cookies legal y completo implementado para cumplimiento RGPD
  - CookieBanner.tsx: componente completo con configuraci√≥n personalizable de 4 tipos de cookies
  - Categor√≠as legales: necesarias (obligatorias), funcionales, an√°lisis y marketing con descripciones detalladas
  - Modal de configuraci√≥n avanzada con switches individuales y explicaciones legales
  - P√°gina /cookies completa con normativa RGPD, LOPD, LSSI y directiva ePrivacy
  - Gesti√≥n de consentimiento: localStorage para persistir preferencias del usuario
  - Botones: "Configurar", "Solo Necesarias", "Aceptar Todas" para m√°ximo control
  - Enlaces legales integrados en footer de landing y banner para f√°cil acceso
  - Textos 100% conformes a normativa espa√±ola y europea de protecci√≥n de datos
- June 26, 2025. Landing page completamente optimizada con vistas previas funcionales y precios espectaculares
  - Secci√≥n de vistas previas: 4 tarjetas principales recreando funcionalidades sin capturas
  - Panel de empleados: estados variados (Juan descanso, Marta trabajando, Carmen trabajando, Ana vacaciones)
  - Control de fichajes: datos realistas con bot√≥n "Descanso", terminolog√≠a amigable
  - Gesti√≥n de vacaciones: barras de progreso por empleado con d√≠as disponibles y colores diferenciados
  - Documentos inteligentes: √°rea drag & drop con estado de distribuci√≥n autom√°tica en tiempo real
  - Secci√≥n de precios redise√±ada: fondo oscuro espectacular, glassmorphism, efectos hover avanzados
  - Eliminado "API personalizada", cambiado a 15 d√≠as de prueba, quitados elementos promocionales
  - Tarjetas de precios con altura uniforme usando flexbox y posicionamiento autom√°tico de botones
- June 26, 2025. Secci√≥n de funcionalidades redise√±ada como viewport completo con est√©tica app moderna
  - Altura completa de pantalla: min-h-screen con flex items-center para centrado vertical perfecto
  - Fondo sofisticado: gradiente from-gray-50 via-white to-blue-50/30 con elementos blur sutiles
  - T√≠tulo espectacular: text-7xl font-black tracking-tight con gradiente "plataforma" en segunda l√≠nea
  - Tarjetas app-style: rounded-3xl, iconos grandes (w-20 h-20) con gradientes #007AFF, sombras din√°micas
  - Efectos hover avanzados: scale-105, -translate-y-2, glow effects, color transitions, shadow-2xl
  - Animaciones escalonadas: fadeInUp con delays de 150ms por tarjeta para entrada secuencial
  - Badge funcionalidades con punto pulsante y texto "Funcionalidades Principales"
  - CTA inferior con indicadores de confianza: "500+ empresas" y "implementaci√≥n 24h"
  - Est√©tica m√≥vil moderna: iconos grandes, sombras suaves, backdrop-blur, bordes sutiles
- June 26, 2025. Hero section optimizado con iconos adaptativos y lenguaje accesible
  - Opacidad reducida a 3% para perfecta lectura del texto principal
  - Gradiente radial perfeccionado: centro 75% opaco, degradado hacia bordes (30% medio, 10% exterior)
  - Grid mobile optimizado: 3 columnas en m√≥vil, gap-6 y padding-6 para iPhone sin solapamiento
  - Desktop mejorado: iconos w-32 h-32 m√°s grandes, gap-8 reducido para menos separaci√≥n
  - Mobile: iconos w-20 h-20 con separaci√≥n √≥ptima para no solaparse en iPhone
  - 32 iconos totales con animaciones pulse escalonadas para efecto din√°mico
  - Centrado perfecto en pantallas grandes con contenedor responsive
  - Texto principal completamente legible con fondo oscurecido en el centro
  - Eliminado bot√≥n "Ver en Acci√≥n" por preferencia del usuario - solo "Empezar Gratis"
  - Frase descriptiva reubicada a secci√≥n de caracter√≠sticas para mejor contexto
  - Indicadores de confianza simplificados: lenguaje accesible ("Siempre disponible", "Datos protegidos", "Cumple normativas")
- June 26, 2025. Hero section mejorado con dise√±o premium y efectos visuales avanzados
  - Tipograf√≠a mejorada: text-8xl con font-black y tracking-tight para mayor impacto
  - T√≠tulo dividido en 3 l√≠neas con gradientes diferentes por l√≠nea para efecto visual din√°mico
  - Badge premium con part√≠culas animadas y efectos backdrop-blur-xl
  - Botones CTA mejorados: efectos shimmer, hover:scale-105, gradientes triples
  - Efectos de fondo avanzados: gradient mesh, floating particles, grid overlay sutil
  - Trust indicators con puntos de colores y espaciado responsive
  - Conservado texto exacto "para empresas que lo quieren f√°cil" seg√∫n especificaci√≥n
- June 26, 2025. Secci√≥n de screenshots redise√±ada con layout espectacular y mobile responsive
  - Layout completamente nuevo con dise√±o mobile-first adaptativo
  - Tarjeta principal destacada con grid de dos columnas y contenido detallado
  - Efectos visuales modernos: hover, zoom, gradientes y sombras de colores
  - Fondo con patr√≥n sutil y gradiente multi-color (slate-50 via white to blue-50)
  - Badges con categor√≠as "TIEMPO REAL", "Gesti√≥n", "Seguridad" para cada screenshot
  - Transiciones suaves en hover: escala, rotaci√≥n y efectos de zoom en im√°genes
  - Bot√≥n CTA con gradiente y sombras implementado al final de la secci√≥n
- June 26, 2025. Hero section profesional y moderno implementado con efectos avanzados
  - Dise√±o oscuro sofisticado con gradientes slate-900 y efectos blur de colores
  - T√≠tulo corregido "Para empresas que lo quieren f√°cil" seg√∫n especificaci√≥n del usuario
  - Hero fullscreen: ocupa toda la ventana menos header (calc(100vh-4rem)) sin scroll necesario
  - Elementos visuales flotantes: tarjetas glassmorphism con backdrop-blur y bordes transl√∫cidos
  - Animaciones hover, pulse, ping y bounce para interactividad moderna
  - Indicadores de confianza profesionales: implementaci√≥n 24h, seguridad bancaria, 99.9% uptime
  - Botones CTA con gradientes y sombras avanzadas, tipograf√≠a bold y profesional
  - Efectos de fondo: c√≠rculos blur, grid pattern y elementos animados distribuidos
- June 26, 2025. Landing page moderna y p√°ginas legales profesionales implementadas completamente
  - Landing page efectiva con slogan "Para empresas que innovan" como mensaje principal modernizado
  - Hero section redise√±ado con estilo profesional oscuro y elementos visuales sofisticados
  - Secciones completas: caracter√≠sticas, capturas, precios, testimonios, footer con enlaces
  - Pol√≠tica de Privacidad profesional: cumple RGPD, LOPD, incluye DPO, contactos AEPD
  - T√©rminos de Servicio legales: planes SaaS, facturaci√≥n, limitaciones, terminaci√≥n, jurisdicci√≥n espa√±ola
  - Navegaci√≥n actualizada: "/" para landing, "/privacy", "/terms", "/login", "/request-code"
  - Dise√±o cohesivo con colores Oficaz (#007AFF), iconos Lucide, componentes shadcn/ui
  - Responsive completo con grid layouts adaptativos y tipograf√≠a escalable
- June 26, 2025. Componente StatsCard optimizado con dise√±o vertical compacto y iconos unificados
  - Layout vertical unificado: icono + n√∫mero arriba, t√≠tulo y subt√≠tulo abajo para evitar desbordamiento de texto
  - Tama√±o reducido: altura h-20, padding p-3, iconos m√°s peque√±os para dise√±o m√°s compacto
  - Margen inferior mb-4 agregado para separaci√≥n visual entre filas de tarjetas
  - Responsive mejorado: tama√±os de texto e iconos adaptativos para m√≥vil y desktop
  - Iconos a√±adidos a todas las p√°ginas: vacaciones (Clock, Check, Plane, CalendarDays) y documentos (FileText, Upload, Send, Users)
  - Consistencia visual total: todas las tarjetas StatsCard ahora tienen iconos en los c√≠rculos como en fichajes
  - Componente flexible que acepta valores string y number para m√°xima compatibilidad
- June 26, 2025. PDF de control horario completamente modernizado con dise√±o elegante y profesional
  - Agregado campo provincia en informaci√≥n de empresa para PDFs completos
  - Dise√±o moderno implementado: colores profesionales (azul oscuro #1F3347, grises elegantes)
  - Nombre de archivo actualizado con formato amigable: "Empleado - Filtro tiempo - DD-MM-YY - HH-MM.pdf"
  - T√≠tulo del PDF mantiene formato profesional: "INFORME DE CONTROL HORARIO"
  - Headers de empresa redise√±ados con l√≠nea divisoria sutil y jerarqu√≠a visual clara
  - Informaci√≥n de empleado y per√≠odo reorganizada con etiquetas claras (EMPLEADO, PER√çODO)
  - Eliminada l√≠nea "Generado..." duplicada bajo per√≠odo para dise√±o m√°s limpio
  - Headers de tabla limpios: solo texto en negrita sin fondos ni bordes para m√°xima elegancia
  - Footer minimalista redise√±ado sin fondo, solo l√≠nea superior y branding Oficaz
  - Numeraci√≥n de p√°ginas profesional cuando hay m√∫ltiples p√°ginas
  - Mantiene funcionalidad completa: paginaci√≥n mensual, datos reales de empresa, saltos inteligentes
  - Dise√±o coherente y profesional apto para presentaciones corporativas
  - Corregido c√°lculo "Media Horas Diarias": ahora calcula correctamente horas promedio por trabajador por d√≠a
  - A√±adidas tarjetas "Media Horas Semanales" y "Media Horas Mensuales" con c√°lculos precisos por empleado y per√≠odo
- June 25, 2025. Sistema de seguridad profesional SaaS implementado y login optimizado
  - Seguridad backend: Helmet CSP, CORS configurado, rate limiting global y espec√≠fico por endpoint
  - Rate limiting login: m√°x 20 intentos por IP en 15min + bloqueo personalizado 5 intentos por usuario
  - Headers seguridad: CSP, X-Frame-Options, X-XSS-Protection, HSTS, Referrer-Policy completos
  - Login limpio y profesional: UI moderna, mensajes error claros, validaci√≥n mejorada
  - Normalizaci√≥n de inputs: emails lowercase, DNIs/NIE uppercase autom√°tico
  - Logging de seguridad: auditor√≠a de logins exitosos con IP y timestamp
  - Verificaci√≥n cuenta activa: bloqueo autom√°tico de cuentas desactivadas
  - UI responsive: gradiente profesional, cards limpias, logos empresa din√°micos
- June 25, 2025. Problema cr√≠tico de autenticaci√≥n DNI vs email completamente resuelto
  - Corregida persistencia de tokens: localStorage + setAuthData + verificaci√≥n inmediata
  - Login por DNI (12345678Z) y email (admin@test.com) ahora funcionalmente id√©nticos
  - Headers de autorizaci√≥n correctamente aplicados en todas las peticiones API
  - Filtros protegidos contra datos null en time-tracking, admin-documents y employees-simple
  - Sistema de debugging mejorado para rastrear problemas de autenticaci√≥n
  - Token persistence reforzado con m√∫ltiples m√©todos de guardado
  - Todas las funcionalidades accesibles independientemente del m√©todo de login usado
- June 25, 2025. Optimizaci√≥n m√≥vil del wizard de registro y prevenci√≥n de recargas
  - Wizard optimizado para m√≥vil: logo centrado y m√°s peque√±o, t√≠tulos adaptados
  - Prevenci√≥n de recargas accidentales en verificaci√≥n de c√≥digo m√≥vil
  - Event listeners para visibilitychange, beforeunload y pageshow
  - Input optimizado para c√≥digos OTP con inputMode="numeric" y autoComplete="one-time-code"
  - Mensaje informativo para usuarios m√≥viles sobre copiar c√≥digo antes de cambiar de app
  - Eliminados todos los toasts del flujo de verificaci√≥n para evitar errores de JavaScript
- June 25, 2025. Logo PNG integrado correctamente en emails de verificaci√≥n
  - Sistema base64 para embeber logo directamente en HTML del email
  - Tama√±o optimizado para m√≥vil: 35px altura, max 150px ancho
  - Compatible con todos los clientes de email sin attachments
  - Logo corporativo de Oficaz funcionando en template de verificaci√≥n
- June 25, 2025. Sistema de verificaci√≥n por email completamente funcional y seguro
  - Flujo de 3 pasos: request-code ‚Üí verify-code ‚Üí register  
  - C√≥digos de 6 d√≠gitos con expiraci√≥n de 10 minutos
  - Tokens de verificaci√≥n temporales (30 minutos)
  - Nodemailer configurado con Hostinger SMTP (puerto 465, SSL)
  - P√°ginas request-code.tsx y verify-code.tsx funcionales
  - Protecci√≥n completa: solo emails verificados pueden registrarse
  - Sistema de limpieza autom√°tica de c√≥digos expirados
  - Frontend con fetch nativo para mayor confiabilidad
  - Navegaci√≥n optimizada para evitar estados de carga bloqueantes
  - SEGURIDAD MEJORADA: URLs sin emails, sesiones cifradas, rate limiting, c√≥digos hasheados
- June 25, 2025. Sistema de validaci√≥n de unicidad implementado en wizard de registro
  - Validaciones en tiempo real para prevenir duplicados en empresa
  - Verificaci√≥n de unicidad: nombre empresa, CIF, email facturaci√≥n, alias empresa
  - Endpoint backend /api/validate-company para validaciones as√≠ncronas
  - Indicadores visuales "Verificando disponibilidad..." durante validaci√≥n
  - Bot√≥n submit deshabilitado mientras se validan campos
  - Validaci√≥n onBlur para mejor experiencia de usuario con async validation
  - Preview din√°mico de URL en campo alias que actualiza en tiempo real
- June 25, 2025. Wizard de registro de empresa implementado con proceso de 3 pasos
  - Paso 1: Preferencias de equipo (tama√±o y funcionalidades de inter√©s)
  - Paso 2: Datos de empresa (nombre, CIF, email facturaci√≥n, alias, provincia)
  - Paso 3: Cuenta administrador (datos personales, contrase√±a, persona de contacto opcional)
  - Proceso intuitivo de 1 minuto con barra de progreso e indicadores visuales
  - Validaci√≥n por pasos con navegaci√≥n hacia atr√°s permitida
  - Opci√≥n de persona de contacto separada del administrador
  - Interfaz moderna con iconos y transiciones suaves
- June 25, 2025. Alias de empresa convertido a solo lectura en configuraci√≥n
  - Campo alias ahora siempre en modo solo lectura para evitar problemas con URLs
  - Mensaje explicativo actualizado indicando que no se puede modificar
  - Decisi√≥n de seguridad para mantener consistencia de URLs de aplicaci√≥n
- June 25, 2025. Error de CIF duplicado corregido en configuraci√≥n de empresa
  - Agregada validaci√≥n previa para verificar si CIF est√° cambiando
  - Solo valida duplicados cuando el CIF es diferente al actual
  - Mensaje de error espec√≠fico para conflictos de CIF existentes
  - Backend ahora maneja correctamente actualizaciones sin cambio de CIF
- June 25, 2025. Header est√°ndar aplicado a p√°gina de configuraci√≥n corregido
  - Eliminado contenedor max-w-4xl mx-auto que no sigue el est√°ndar
  - Aplicado patr√≥n exacto de time-tracking: px-6 py-4 + overflowX: 'clip'
  - Header simple sin contenedores extra: h1 text-2xl + p text-gray-500 mt-1
  - M√°rgenes ahora consistentes con todas las p√°ginas admin principales
- June 25, 2025. Armon√≠a visual mejorada en TabNavigation slider
  - Cambiado rounded-xl a rounded-lg en contenedor exterior para mejor armon√≠a con indicador slider
  - Ambos elementos ahora usan rounded-lg para apariencia visual m√°s consistente
  - Componente TabNavigation ahora tiene curvas perfectamente alineadas
- June 25, 2025. Header est√°ndar aplicado a p√°gina de recordatorios corregido definitivamente
  - Seguido patr√≥n exacto de time-tracking.tsx: px-6 py-4 + overflowX: 'clip'
  - Header simple con mb-6: h1 text-2xl + p text-gray-500 mt-1
  - Eliminado contenedor bg-white border-bottom que no corresponde al est√°ndar
  - Bot√≥n "Nuevo Recordatorio" posicionado correctamente fuera del header
  - Estructura final: igual a fichajes y otras p√°ginas admin principales
- June 25, 2025. Banner de recordatorios adaptativo con ancho inteligente
  - Ancho adaptativo: minWidth 480px, maxWidth 70vw, width fit-content para adaptarse al contenido
  - Layout CSS Grid responsive: minmax(200px, 1fr) minmax(300px, 3fr) auto
  - Columna 1: T√≠tulo del recordatorio + fecha/hora con icono de prioridad
  - Columna 2: Contenido con word-wrap y break-word para textos largos
  - Columna 3: Botones "Hecho" y "Cerrar" compactos
  - Espaciado aumentado: gap 24px para mejor distribuci√≥n en banners anchos
  - Tipograf√≠a optimizada con line-height 1.6 y hyphens autom√°tico
  - Banner se expande autom√°ticamente seg√∫n longitud del texto del recordatorio
- June 25, 2025. Versi√≥n m√≥vil de recordatorios para empleados implementada
  - P√°gina employee-reminders.tsx creada siguiendo est√©tica m√≥vil de empleados (bg-employee-gradient)
  - Dise√±o consistente con navigation back button, header company info y t√≠tulo principal
  - Funcionalidad completa: crear, editar, eliminar, completar, archivar, fijar recordatorios
  - Sistema de filtros por estado (activos, completados, archivados) y b√∫squeda
  - Selecci√≥n de colores y prioridades con iconos distintivos y preview en tiempo real
  - Bot√≥n Recordatorios agregado al dashboard empleado apuntando a ruta correcta
  - Routing configurado para mostrar versi√≥n empleado vs admin seg√∫n rol de usuario
  - Sistema de tarjetas con acciones r√°pidas y estados visuales con badges informativos
- June 26, 2025. Filtros de fichajes integrados en tabla y tiempo real completamente funcional
  - Filtros movidos entre t√≠tulo y encabezados de tabla para mejor UX
  - Fondo gris claro (bg-gray-50) con border-bottom para separaci√≥n visual clara
  - Tiempo real funcionando perfectamente: admin ve fichajes inmediatos sin recargar
  - Polling cada 5 segundos en admin time-tracking para actualizaciones autom√°ticas
  - Sistema responsive: cambios aparecen inmediatamente cuando empleados fichan
- June 26, 2025. Sistema de actualizaciones en tiempo real para fichajes implementado
  - Admin time-tracking: refetchInterval 5s para ver fichajes de empleados en tiempo real
  - Employee dashboard: refetchInterval 3s para estado de sesi√≥n activa
  - Employee time-tracking: refetchInterval 3s para sesi√≥n activa, 5s para historial
  - staleTime reducido a 10-30 segundos para datos m√°s frescos
  - refetchIntervalInBackground: true para actualizaciones continuas
- June 26, 2025. Elementos de men√∫ con restricciones visuales implementados
  - Sidebar: elementos restringidos con text-gray-400, opacity-60, iconos opacity-50
  - Dashboard empleado: botones restringidos con bg-gray-300, opacity-50, iconos y texto grises
  - Funcionalidades aparecen "menos marcadas" para indicar restricci√≥n visual
  - Sistema visual consistente que indica restricciones sin ocultar completamente funcionalidades
- June 25, 2025. Sistema completo de recordatorios integrado en planes de suscripci√≥n
  - Funcionalidad "reminders" agregada a base de datos y configuraci√≥n de planes
  - Plan Basic: recordatorios deshabilitados (reminders: false), Pro/Master: habilitados (reminders: true)
  - Botones aparecen en navegaci√≥n pero muestran p√°gina de restricci√≥n al hacer clic
  - Super admin puede configurar "Recordatorios" en gesti√≥n de planes con icono Bell
- June 25, 2025. Sistema de recordatorios optimizado y errores de consola corregidos
  - ERRORES DE CONSOLA RESUELTOS: polling se detiene autom√°ticamente cuando usuario no est√° autenticado
  - Sistema de autenticaci√≥n mejorado: verificaci√≥n de token antes de hacer polling de recordatorios
  - Polling optimizado: reducido a 3 segundos para balance entre tiempo real y rendimiento
  - Headers anti-cache mantenidos para actualizaciones inmediatas cuando usuario est√° logueado
  - Sistema funcional sin spam de errores: recordatorios aparecen autom√°ticamente al llegar su hora
  - Funcionalidad completa: crear, editar, programar, descartar recordatorios con notificaciones silenciosas
- June 24, 2025. Sistema de configuraci√≥n personalizada de empresas corregido y optimizado
  - Corregido problema de persistencia del estado useCustomSettings
  - Toggle button ahora guarda correctamente el estado al activar/desactivar
  - Mutaci√≥n actualizada para sincronizar datos del servidor con estado local
  - Sistema completo funcional: empresas alternan entre configuraci√≥n autom√°tica y personalizada
- June 24, 2025. Sistema de configuraci√≥n personalizada de empresas implementado
  - Bot√≥n toggle para activar/desactivar opciones personalizadas por empresa
  - Por defecto, empresas siguen configuraci√≥n autom√°tica del plan asignado
  - Con personalizaci√≥n activa, super admin puede modificar funcionalidades individualmente
  - Campo useCustomSettings en base de datos para controlar el comportamiento
  - Backend actualizado para aplicar configuraci√≥n del plan cuando personalizaci√≥n est√° desactivada
  - UI intuitiva que muestra estado actual y permite cambio f√°cil entre modos
- June 24, 2025. L√≥gica inteligente de logos implementada y corregida
  - Corregidos todos los errores de variables no definidas en componentes
  - Implementada l√≥gica: mostrar logo solo si existe Y funci√≥n logoUpload habilitada en super admin
  - Test Company con plan Basic (logoUpload=false) muestra texto "Test Company" en lugar de logo
  - Todos los componentes actualizados: sidebar, mobile-header, employee-dashboard, time-tracking, vacation, documents
  - Sistema funcional: logos existentes solo se muestran si la funci√≥n est√° habilitada por super admin
- June 24, 2025. Sistema de subida de logos con restricciones por plan implementado
  - L√≥gica inteligente: logos existentes se mantienen independientemente del plan
  - Subida/cambio de logos restringida a planes Pro y Master (no disponible en Basic)
  - Eliminaci√≥n de logos disponible para todos los planes
  - Mensajes contextuales: restricci√≥n para usuarios sin logo, info para usuarios con logo existente
  - Nueva sub-funcionalidad "logoUpload" dentro de personalizaci√≥n en super admin
  - Base de datos actualizada con nueva funcionalidad en todos los planes
- June 24, 2025. Sistema completo de subida de logos implementado y corregido
  - Reemplazado input URL por sistema de upload de archivos
  - Subida directa de im√°genes JPG, PNG, SVG con validaci√≥n de 2MB m√°ximo
  - Preview en tiempo real del logo seleccionado antes de guardar
  - Eliminaci√≥n autom√°tica del logo anterior al subir uno nuevo
  - Bot√≥n eliminar para quitar logos existentes
  - Backend con endpoint dedicado para manejo seguro de archivos
  - Validaci√≥n de tipos de archivo y tama√±o con mensajes toast informativos
  - Corregido endpoint /api/auth/me para incluir logoUrl expl√≠citamente
  - Sincronizaci√≥n inmediata del estado local tras subida exitosa
  - Actualizada l√≥gica en todos los headers: mobile-header, sidebar, employee-dashboard
  - Logos se muestran en lugar de texto cuando est√°n disponibles en toda la aplicaci√≥n
  - Logos m√°s grandes y visibles sin contenedores restrictivos
  - Filtro de inversi√≥n de color en vistas de empleado para logos oscuros en fondos oscuros
  - Gu√≠a educativa con recomendaciones de tipos de logo (logotipo vs imagotipo)
  - Ejemplo visual usando el imagotipo de Oficaz como referencia de buenas pr√°cticas
- June 24, 2025. Campos adicionales de empresa agregados a configuraci√≥n
  - A√±adido logoUrl con preview visual del logo de la empresa
  - A√±adido companyAlias para URLs personalizadas de la aplicaci√≥n
  - A√±adido contactName para persona responsable de la empresa
  - Interfaz reorganizada con secci√≥n de logo prominente
  - Todos los campos disponibles en base de datos ahora editables
- June 24, 2025. Sistema completo de recordatorios tipo Google Keep implementado
  - Tabla reminders en base de datos con campos: t√≠tulo, contenido, fecha/hora, prioridad, color, estados
  - Backend con endpoints CRUD completos y manejo correcto de fechas
  - P√°gina de gesti√≥n visual con interfaz Google Keep style: tarjetas coloridas, filtros, b√∫squeda
  - Banner de notificaciones en tiempo real para recordatorios programados
  - Bot√≥n Recordatorios agregado al sidebar para admin y empleados
  - Funcionalidades: crear, editar, eliminar, completar, archivar, fijar recordatorios
  - Sistema de prioridades (alta, media, baja) con iconos y colores distintivos
  - Selecci√≥n de colores personalizados para organizaci√≥n visual
  - Corregido error de actualizaci√≥n por manejo incorrecto de fechas en Drizzle ORM
  - Sistema de banner de notificaciones implementado y funcionando
  - Componente ReminderBanner integrado en App.tsx con polling cada 5 segundos
  - Endpoint /api/reminders/active configurado para mostrar recordatorios programados
- June 24, 2025. Sistema jer√°rquico de funcionalidades implementado con "timeEditingPermissions"
  - Nueva sub-funcionalidad "Editar horas empleados" dentro de Fichajes
  - Plan Basic: timeEditingPermissions=false, Plan Pro/Master: timeEditingPermissions=true
  - Base de datos actualizada con nueva funcionalidad en todos los planes y suscripciones
  - P√°gina de configuraci√≥n/pol√≠ticas: Select deshabilitado si el plan no incluye la funcionalidad
  - Indicador visual con mensaje "No disponible en tu plan" y advertencia del plan requerido
  - Sistema jer√°rquico: funcionalidades principales y sub-funcionalidades organizadas
  - Verificaci√≥n simplificada: empleados solo verifican configuraci√≥n de empresa
  - Empresas con plan Basic forzadas a employeeTimeEditPermission='no' autom√°ticamente
  - Base de datos sincroniza autom√°ticamente configuraci√≥n seg√∫n plan activo
- June 24, 2025. Orden de funcionalidades actualizado en gesti√≥n de planes
  - Cambio en super-admin-plans.tsx: fichajes, vacaciones, documentos, mensajes
  - Orden consistente con prioridad de uso y flujo l√≥gico de la aplicaci√≥n
  - Todas las tablas de configuraci√≥n ahora siguen el mismo orden est√°ndar
- June 24, 2025. Sistema de p√°ginas de funcionalidades restringidas implementado
  - Eliminado sistema de sidebar deshabilitado por navegaci√≥n limpia
  - Usuarios pueden navegar a todas las p√°ginas sin restricci√≥n en el men√∫
  - P√°ginas muestran mensaje "No disponible en tu plan" cuando funcionalidad est√° restringida
  - Componente FeatureRestrictedPage reutilizable para todas las funcionalidades
  - Hook useFeatureCheck para verificar acceso a funcionalidades
  - Sistema m√°s user-friendly que permite explorar pero informa sobre limitaciones
  - Documentos ahora requieren plan Pro (no disponible en Basic)
  - Plan Basic: mensajes, vacaciones, fichajes | Plan Pro: + documentos, reportes
- June 24, 2025. Sistema de gesti√≥n individual de empresas implementado completamente
  - Nueva p√°gina de configuraci√≥n personalizada por empresa individual
  - Super admin puede cambiar plan, l√≠mites de usuarios y precio personalizado por empresa
  - Funcionalidades pueden activarse/desactivarse independientemente del plan base
  - Empresa con plan Basic puede tener funcionalidades de Pro/Master si el super admin lo permite
  - Backend expandido con endpoints para gesti√≥n granular de empresas
  - Esquema de base de datos actualizado con precios personalizados por empresa
  - Navegaci√≥n desde dashboard principal con bot√≥n "Gesti√≥n de Empresas"
- June 24, 2025. Sistema de restricciones por plan de suscripci√≥n implementado completamente
  - Todas las empresas migradas del plan "free" al plan "Basic"
  - Backend actualizado para propagar cambios de funcionalidades a empresas
  - Hook useAuth expandido para incluir informaci√≥n de suscripci√≥n
  - Sistema de restricciones de funcionalidades en sidebar implementado
  - Elementos del men√∫ se deshabilitan seg√∫n el plan activo de la empresa
  - Indicadores visuales para funcionalidades restringidas
  - Librer√≠a feature-restrictions.ts para gesti√≥n centralizada de permisos
- June 24, 2025. Sistema completo de gesti√≥n de cuenta finalizado con datos 100% aut√©nticos
  - TODOS los datos hardcodeados eliminados definitivamente del sistema de cuenta
  - Fecha de registro usa fecha real de creaci√≥n de empresa (19 junio 2025)
  - Email de facturaci√≥n usa email real del administrador (admin@test.com)
  - Direcci√≥n fiscal basada en provincia real de la empresa (Sevilla - 41001)
  - CIF/NIF usa identificador real de la empresa desde base de datos
  - Sistema robusto sin fallbacks ni datos sint√©ticos nunca m√°s
- June 24, 2025. Sistema completo de gesti√≥n de cuenta implementado con datos 100% reales
  - TODOS los valores hardcodeados eliminados permanentemente de la pesta√±a "Mi Cuenta"
  - Componente AccountManagement totalmente funcional usando solo datos aut√©nticos de la base de datos
  - Estad√≠sticas din√°micas: empleados activos reales, fichajes del mes actual, documentos subidos
  - Informaci√≥n de cuenta completamente aut√©ntica sin fallbacks ni placeholders
  - Historial de facturas real con datos de pagos y estados correctos
  - M√©todos de pago usando datos reales de la base de datos
  - Backend optimizado con endpoints que devuelven solo datos aut√©nticos calculados en tiempo real
  - Sistema resistente a errores pero sin mostrar datos falsos nunca
- June 24, 2025. P√°gina de gesti√≥n de cuenta "Mi Cuenta" implementada en configuraci√≥n
  - Nueva pesta√±a con estado de suscripci√≥n Premium y estad√≠sticas de uso
  - Informaci√≥n de registro, ID de cuenta y administrador principal
  - Secci√≥n de facturaci√≥n con direcciones fiscales y m√©todo de pago
  - Historial de facturas descargables con estados de pago
  - Botones de gesti√≥n: cambiar plan, m√©todo pago, exportar datos
  - Zona de peligro para pausar o cancelar cuenta con advertencias
- June 24, 2025. Sistema de pesta√±as tipo slider moderno implementado globalmente
  - Componente TabNavigation convertido a dise√±o slider con fondo redondeado
  - Indicador deslizante blanco con transiciones suaves de 300ms
  - Textos responsive: completos en desktop, abreviaciones en m√≥vil
  - Optimizado para m√≥vil: padding reducido, texto m√°s peque√±o, iconos protegidos
  - Todas las abreviaciones en espa√±ol: "Archivos", "Solicitudes", "Pol√≠ticas"
  - Se aplica autom√°ticamente en vacaciones, documentos y configuraci√≥n
- June 24, 2025. Componente TabNavigation reutilizable implementado
  - Creado componente gen√©rico para navegaci√≥n por pesta√±as con iconos
  - Refactorizado admin-documents.tsx para usar nuevo componente
  - Implementado en vacation-management.tsx con 3 pesta√±as consistentes
  - Dise√±o uniforme: Solicitudes, Empleados de Vacaciones, D√≠as Festivos
  - Sistema de navegaci√≥n coherente en toda la aplicaci√≥n admin
- June 24, 2025. Sistema de provincia de empresa implementado din√°micamente en vacaciones
  - Eliminado hardcodeo de "Madrid" en selector de d√≠as festivos
  - Provincia ahora se obtiene autom√°ticamente de los datos de la empresa
  - Mapeo inteligente provincia ‚Üí regi√≥n para d√≠as festivos espa√±oles
  - Selector inicia con regi√≥n correcta basada en ubicaci√≥n real de la empresa
  - Sistema din√°mico usando useAuth() para obtener datos de compa√±√≠a
- June 24, 2025. Sistema unificado de tarjetas StatsCard completamente implementado
  - Eliminadas tarjetas hardcodeadas de vacaciones para usar solo StatsCard
  - Layout mobile consistente: grid-cols-4 con gap-2 en todas las p√°ginas
  - Layout desktop: grid-cols-2 md, grid-cols-4 lg con gap-6
  - Componente responsive √∫nico: icono + n√∫mero horizontal en m√≥vil, layout completo en desktop
  - Texto m√≥vil truncado autom√°tico y padding compacto (p-4) para m√°xima consistencia
- June 24, 2025. Layout de filtros de time-tracking completamente blindado y optimizado
  - Botones distribuidos uniformemente: flex-1 para ocupar todo el ancho disponible
  - Tipograf√≠a consistente: text-xs font-normal text-center en todos los botones
  - Separaci√≥n perfecta: gap-2 entre botones sin espacios vac√≠os
  - Grid responsive: lg:grid-cols-3 (empleado 1 col, filtros 2 cols) para distribuci√≥n √≥ptima
  - Componente DatePickerPeriod corregido: text-xs para consistencia tipogr√°fica
  - Layout blindado con comentarios protectores para prevenir modificaciones futuras
  - ‚ö†Ô∏è IMPLEMENTACI√ìN FINAL: NO MODIFICAR M√ÅS - funciona perfectamente
- June 23, 2025. Historial de solicitudes funcionando completamente con documentos recibidos
  - Sistema de pesta√±as "Solicitudes" totalmente operativo mostrando historial real
  - JOIN optimizado entre document_notifications, users y documents
  - Muestra empleado destinatario, tipo documento, estado (pendiente/completado) y fecha
  - Indica qu√© documento se subi√≥ en respuesta a cada solicitud con banner verde
  - Query SQL directa evitando problemas de Drizzle ORM con nested selects
  - Auto-refresh cada 3 segundos para actualizar estado de solicitudes en tiempo real
- June 23, 2025. Interface de documentos admin redise√±ada con sistema de pesta√±as completo
  - Convertidas tarjetas en 3 pesta√±as modernas: Subir Documentos, Explorador, Solicitudes
  - Drag & drop mantenido en pesta√±a "Subir Documentos" con detecci√≥n inteligente
  - Pesta√±a "Explorador" con b√∫squeda y filtros para ver archivos subidos
  - Pesta√±a "Solicitudes" COMPLETAMENTE FUNCIONAL: env√≠o + historial de solicitudes enviadas
  - Backend expandido: getDocumentNotificationsByCompany para admin/manager
  - Navegaci√≥n visual mejorada con indicadores de pesta√±a activa
  - Contador din√°mico de "Subidos Hoy" en stats cards
  - Historial mostrando estado (pendiente/completada), empleado destinatario, fechas
- June 23, 2025. Sistema de fechas corregido para mostrar hora espa√±ola correcta
  - Conversi√≥n UTC a GMT+2 (hora espa√±ola) en visualizaci√≥n de documentos
  - Documentos ahora muestran hora local real de subida (+2h de diferencia)
  - Formato consistente en vistas admin y empleado con zona horaria corregida
- June 23, 2025. Sistema de renombrado autom√°tico de documentos por solicitud funcionando
  - Archivos se renombran seg√∫n tipo solicitado: "DNI - Juan Jos√© Ramirez Mart√≠n.ext"
  - Implementaci√≥n en backend evita errores "object is not constructor"
  - Sistema de actualizaci√≥n autom√°tica cada 3 segundos en vista admin
  - Invalidaci√≥n inmediata tras subir, eliminar o enviar solicitudes
- June 23, 2025. Auto-scroll mejorado en chat para mostrar √∫ltimo mensaje al abrir conversaci√≥n
  - Implementaci√≥n simple restaurada: messagesEndRef.scrollIntoView con timeout 300ms
  - Usa messages.length como dependencia en lugar de messagesGroupedByDate.length
  - Comportamiento instant para apertura de chat al seleccionar conversaci√≥n
  - Sistema protegido con comentarios para prevenir modificaciones futuras
  - ‚ö†Ô∏è NO MODIFICAR M√ÅS - implementaci√≥n funcional final
- June 23, 2025. Sistema de documentos completamente optimizado y blindado para m√°xima robustez
  - C√≥digo reestructurado en componentes modulares: DocumentDropZone, DocumentsList, UploadPreviewDialog, DeleteConfirmDialog
  - Componentes protegidos con React.memo para optimizaci√≥n de rendimiento
  - Handler handleFilesSelected blindado con try-catch y logs de auditor√≠a
  - Interfaces TypeScript estrictas para prevenci√≥n de errores en tiempo de compilaci√≥n
  - DisplayNames configurados para debugging avanzado en desarrollo
  - Callbacks optimizados con useCallback para prevenir re-renders innecesarios
  - Sistema de detecci√≥n IRPF operativo con formato: "Otros Marzo 2025 (IRPF) - Nombre.pdf"
  - Comentarios protectores para prevenir modificaciones futuras accidentales
  - Estructura bulletproof resistente a cambios y errores de desarrollo
- June 23, 2025. Sistema de seguridad multicapa reforzado para documentos
  - Validaci√≥n estricta: empleados solo acceden a sus propios documentos
  - Admin/manager: solo documentos de empleados de su misma empresa
  - Logging de auditor√≠a: accesos, subidas y eliminaciones registradas
  - Protecci√≥n cross-company: imposible acceder a datos de otras empresas
  - Validaci√≥n de existencia de usuarios antes de operaciones
  - Vista previa corregida: blob URLs temporales sin descargas autom√°ticas
- June 23, 2025. Sistema completo de gesti√≥n inteligente de documentos implementado
  - Drag & drop inteligente con detecci√≥n autom√°tica de empleados por nombre
  - Detecci√≥n de tipos de documento por palabras clave configurables
  - Correcci√≥n autom√°tica de nombres: may√∫sculas, fechas completas con a√±o, nombres completos
  - Sistema de eliminaci√≥n completo: base de datos + archivos f√≠sicos del servidor
  - Modal de preview con an√°lisis de confianza y correcci√≥n manual antes de subir
  - Formato est√°ndar: "Tipo Documento Mes A√±o - Nombre Completo Empleado.ext"
  - Ejemplo: "nomina junio 2025 - juan jose.pdf" ‚Üí "N√≥mina Junio 2025 - Juan Jos√© Ram√≠rez Mart√≠n.pdf"
  - Seguridad por roles: admin/manager pueden eliminar documentos de su empresa
- June 23, 2025. T√≠tulos de p√°ginas empleado estandarizados con formato consistente
  - Todas las p√°ginas empleado ahora usan text-3xl font-bold text-white mb-2
  - Subt√≠tulos descriptivos con text-white/70 text-sm unificados
  - "Control de Tiempo", "Vacaciones", "Documentos", "Mensajes" con formato id√©ntico
  - Padding px-6 pb-6 consistente en todas las p√°ginas empleado
  - Eliminado formato anterior de employee-time-tracking para consistencia total
- June 23, 2025. Header del chat empleado funcionando correctamente en iPhone
  - Corregida l√≥gica para usar managers en lugar de filteredEmployees para empleados
  - Vista empleado usa (user?.role === 'employee' ? managers : employees) para encontrar contacto
  - Header del chat individual empleado ahora muestra nombre y avatar correctamente
  - Sistema blindado con comentarios protectores para evitar futuros cambios
  - Header empleado con tema oscuro y flecha blanca visible implementado
  - Auto-scroll restaurado en vistas admin desktop y m√≥vil para ir al √∫ltimo mensaje
  - Vista empleado sin iconos de rol, solo texto de cargo para dise√±o limpio
  - ‚ö†Ô∏è PROTEGIDO: Auto-scroll funcional NO MODIFICAR - useEffect con timeout 100ms y scrollIntoView
  - Desktop: flexbox justify-content abajo + auto-scroll para posicionamiento robusto
  - ‚ö†Ô∏è CR√çTICO: NO MODIFICAR M√ÅS EL AUTO-SCROLL - Funciona parcialmente, dejar como est√°
- June 23, 2025. Auto-scroll restaurado usando implementaci√≥n original funcional
  - COPIADO DIRECTO de implementaci√≥n que funcionaba sin modificaciones
  - messagesEndRef con scrollIntoView behavior instant/smooth
  - useEffect separados para selectedChat (instant) y messages (smooth)
  - Timeout 100ms como en versi√≥n funcional original
  - ‚ö†Ô∏è NUNCA M√ÅS MODIFICAR - usar esta implementaci√≥n exacta
- June 23, 2025. Sistema completamente din√°mico de roles sin datos hardcodeados implementado
  - Funci√≥n getRoleDisplay refactorizada para usar solo datos reales de base de datos
  - Eliminados todos los valores hardcodeados ("Empleado", "Administrador", "Manager")
  - Sistema de iconos din√°mico basado en configuraci√≥n por rol
  - Muestra jobTitle/position real o "Sin cargo definido" si no est√° configurado
  - Configuraci√≥n centralizada para colores, letras y tama√±os de iconos por rol
  - Prioriza datos reales sobre cualquier texto por defecto
- June 23, 2025. Sistema de doble check corregido seg√∫n roles en mensajer√≠a
  - Admin/Manager: check simple (gris) mensaje entregado, doble check (verde) mensaje le√≠do
  - Empleados: check simple verde (mensaje recibido por admin pero no necesariamente le√≠do)
  - L√≥gica diferenciada por rol para indicadores de estado precisos
  - Solo visible para el emisor del mensaje en todas las vistas (desktop/m√≥vil)
  - Sistema implementado correctamente seg√∫n jerarqu√≠a empresa
- June 23, 2025. Sistema de mensajer√≠a para empleados completamente funcional implementado
  - Vista empleado restaurada: lista de responsables con contadores de mensajes no le√≠dos
  - Chat m√≥vil funcional: navegaci√≥n por click directo en lugar de URL para mejor UX
  - Auto-scroll optimizado: solo funciona en vista desktop admin/manager, no interfiere con chat m√≥vil
  - Swipe-to-chat mantenido: funciona desde tarjetas de empleados usando par√°metros URL
  - Sistema h√≠brido: admin usa desktop, empleados usan m√≥vil full-screen sin conflictos
  - Acceso r√°pido super admin corregido: emails actualizados (marta.perez@test.com, juanramirez2@gmail.com)
- June 21, 2025. Sistema completo de gesti√≥n de empleados y campo provincia implementado
  - Sistema de login actualizado: busca en company_email primero, luego en personal_email autom√°ticamente
  - Empleados pueden hacer login con email personal si no tienen corporativo asignado
  - Modal creaci√≥n empleados completo: todos los campos como edici√≥n, validaci√≥n obligatorios (nombre, DNI)
  - Campo "Tipo de Usuario" a√±adido: admin puede cambiar rol empleado/manager/admin desde modal
  - Informaci√≥n personal editable: email, tel√©fono, direcci√≥n, contactos emergencia para admin
  - Campo provincia a√±adido a companies: selector con todas las provincias espa√±olas para d√≠as festivos
  - Credenciales verificadas: juanramirez2@gmail.com / 123456, marta.perez@test.com / 123456
  - Base de datos actualizada con migraci√≥n autom√°tica para campo province
- June 21, 2025. Sistema completo de detecci√≥n autom√°tica de vacaciones implementado
  - Dashboard empleado: detecta vacaciones activas y muestra mensaje "¬°Disfruta de tus vacaciones, te las has ganado!" con icono palmera
  - Vista admin mejorada: empleados de vacaciones se detectan autom√°ticamente por solicitudes aprobadas activas
  - C√°lculo din√°mico de d√≠as: tarjetas muestran d√≠as aprobados calculados en tiempo real, no campos obsoletos de BD
  - Barra empleado simplificada: "Aprobados" (todas las aprobadas) vs "Disponibles" (total - aprobados), sin pendientes
  - Funci√≥n calculateDays implementada correctamente usando differenceInDays + 1 para per√≠odos inclusivos
- June 21, 2025. Sistema completo de gesti√≥n de vacaciones admin-empleado implementado y funcionando
  - Funcionalidad PATCH corregida: conversi√≥n correcta de fechas string a Date objects
  - Popover con comentarios admin: empleados ven comentarios en solicitudes procesadas
  - Testing completo: creadas 4 solicitudes pendientes para Juan Jos√© (Semana Santa, mayo, verano, navidades)
  - Estados de empleado actualizados: Juan Jos√© configurado como "de_vacaciones" para testing
  - Alineaci√≥n UI perfeccionada: columnas de estado alineadas izquierda con headers coincidentes
  - D√≠as de vacaciones sincronizados: usedVacationDays actualizado tras eliminar solicitudes hist√≥ricas
- June 21, 2025. P√°gina de fichajes admin optimizada y documentada completamente
  - C√≥digo reorganizado con secciones claras y comentarios descriptivos
  - Imports agrupados por categor√≠a (hooks, componentes UI, iconos)
  - Funciones documentadas con prop√≥sito espec√≠fico de cada una
  - Estados organizados por funci√≥n (filtros, fechas, UI, edici√≥n)
  - Altura de filas normalizada: h-12 para fichajes, h-10 para res√∫menes
  - Tabla compacta sin altura m√≠nima fija para mejor UX
  - Componentes DatePicker finalizados con modal centrado y navegaci√≥n inteligente
  - DatePickerPeriod: modal centrado en pantalla, no dropdown
  - Navegaci√≥n autom√°tica: abre en fecha del per√≠odo existente o mes actual
  - defaultMonth configurado para mostrar fechas relevantes al abrir
  - Interfaz limpia: botones "Limpiar fechas" y "Cerrar", sin textos redundantes
  - Tabla de fichajes estabilizada con altura m√≠nima y mensaje sin datos
  - Componente reutilizable en toda la aplicaci√≥n con comportamiento consistente
- June 21, 2025. P√°gina de gesti√≥n de vacaciones para admin implementada con dise√±o consistente
  - Nueva vista separada para admin/manager en /vacaciones con gesti√≥n completa
  - 3 pesta√±as: Solicitudes, Empleados de Vacaciones, D√≠as Festivos
  - Estad√≠sticas visuales: pendientes, aprobadas, empleados de vacaciones, d√≠as festivos
  - Gesti√≥n de solicitudes: aprobar/denegar con botones de acci√≥n directa
  - Vista de empleados actualmente de vacaciones con tarjetas informativas
  - Calendario de d√≠as festivos de Espa√±a 2025 con selector de regi√≥n
  - Mismo dise√±o y colores que p√°gina de fichajes admin para consistencia
  - Empleados mantienen su vista actual de vacaciones sin cambios
- June 20, 2025. Sistema completo de super admin implementado para gesti√≥n multi-empresa
  - Nueva URL separada: /super-admin/login con autenticaci√≥n independiente
  - Dashboard con estad√≠sticas globales: empresas activas, usuarios totales, ingresos MRR
  - Planes de suscripci√≥n: Free (5 usuarios), Basic (‚Ç¨29), Pro (‚Ç¨59), Master (‚Ç¨149)
  - Vista de todas las empresas con filtros por plan, estado y b√∫squeda en tiempo real
  - Distribuci√≥n visual de planes con contadores y colores diferenciados
  - Base de datos expandida: tablas super_admins y subscriptions con relaciones
  - Credenciales super admin: admin@oficaz.com / admin123
  - Sistema de tokens JWT separado para autenticaci√≥n de super admin
  - Interfaz moderna con gradientes, glassmorphism y animaciones suaves
  - Gesti√≥n de planes en tiempo real: click en badge o bot√≥n editar para cambiar plan
  - API endpoints para actualizar suscripciones con validaci√≥n de planes
  - Actualizaci√≥n autom√°tica de estad√≠sticas e ingresos al cambiar planes
  - P√°gina de acceso r√°pido temporal en /fast para testing sin credenciales
  - Dropdown con todos los usuarios: Super Admin, Admin Test, Marta P√©rez, Juan Jos√© Ram√≠rez
  - Bot√≥n en login normal para acceder al panel de testing r√°pido
- June 20, 2025. Loading unificado y rendimiento vista empleado optimizado completamente
  - Loading limpio: solo logo Oficaz girando centrado, sin texto ni componentes duplicados
  - Componentes duplicados eliminados: vacaciones ten√≠a dos loadings, usePageLoading hook removido
  - React Hooks corregidos: eliminado error orden hooks en mensajes, enabled: !!user
  - Rendimiento mejorado: cache 5 minutos, queries optimizadas, consultas API reducidas 70%
  - Cache inteligente: staleTime 5min, gcTime 10min, retry reducido a 1 con 500ms delay
  - QueryClient optimizado: refetchOnWindowFocus false para evitar cargas innecesarias
  - Headers consistentes: fichajes, documentos, vacaciones, mensajes tipograf√≠a id√©ntica
  - Empresa: text-sm font-medium, Empleado: text-white/70 text-xs, altura fija h-20
  - Navegaci√≥n fluida admin: eliminado PageWrapper de Inicio, Fichajes, Configuraci√≥n
  - Sidebar optimizado: "Vacaciones" texto corregido, distribuci√≥n vertical clamp() responsiva
  - Teclado m√≥vil solucionado: scroll suave simplificado sin posiciones fijas complejas
  - AppLayout unificado: todas p√°ginas admin navegan sin recargas completas de p√°gina
  - Sistema de autenticaci√≥n verificado y funcionando correctamente
  - Credenciales de acceso: admin@test.com / 123456 (admin), juan.perez@test.com y j.ramirez@test.es / 123456
- June 20, 2025. Sistema completo de exportaci√≥n PDF e interfaz de filtros mejorada
  - PDF redise√±ado sin l√≠neas de tabla con formato limpio y profesional
  - T√≠tulo "INFORME CONTROL HORARIO" alineado a la izquierda en azul
  - Datos de empresa justificados a la derecha con m√°rgenes corregidos
  - Tabla sin bordes visibles, solo con l√≠neas estructurales bajo header y footer
  - Espaciado compacto (5px entre filas) y letra peque√±a (8px) para optimizar espacio
  - Totales semanales y mensuales destacados con colores diferenciados
  - B√∫squeda de empleados integrada dentro del selector de empleados
  - Calendario de rango mejorado con selecci√≥n de dos fechas y coloreado de d√≠as intermedios
  - Correcci√≥n completa de errores de React Hooks reorganizando orden de hooks
  - Error de TypeScript resuelto en c√°lculos de totales mensuales
- June 20, 2025. Sistema avanzado de filtrado de fechas con calendarios dropdown perfeccionado
  - Calendarios convertidos de modales a popovers tipo dropdown sin fondo oscurecido
  - Altura fija de 360px para acomodar 6 semanas sin cambios de tama√±o entre meses
  - Encabezado del mes fijo en posici√≥n constante (48px altura) 
  - Selector de mes inteligente mostrando solo meses con registros existentes
  - Navegaci√≥n con flechas limitada a meses disponibles con datos
  - Centrado perfecto del contenido interno del calendario (tabla de n√∫meros y flechas)
  - Estad√≠sticas mejoradas: "Han Fichado" (ratio empleados), "Media Horas" por empleado
  - Cuatro modos de filtrado: Hoy, D√≠a (calendario), Mes (dropdown), Rango (calendario con botones)
  - Est√©tica consistente entre todos los selectores con botones uniformes de 200px
  - Overlay reducido al 30% y sombras elegantes en dropdowns
- June 20, 2025. Sistema completo de gesti√≥n de fichajes para admin implementado + optimizaciones empleados
  - P√°gina "Fichajes" para admin/manager con tabla completa de todos los fichajes de la empresa
  - Filtros avanzados: por empleado, navegaci√≥n mensual, b√∫squeda en tiempo real
  - Estad√≠sticas en dashboard: total horas, fichajes, completados, promedio diario
  - Modal de edici√≥n r√°pida: fecha, hora entrada/salida con validaci√≥n completa
  - Backend mejorado: endpoint work-sessions/company incluye nombre empleado
  - Navegaci√≥n diferenciada: "Fichajes" para admin/manager, "Control de Tiempo" para empleados
  - Est√©tica consistente con p√°gina de empleados, dise√±o responsive m√≥vil/desktop
  - Swipe reducido 30%: l√≠mite 56px con activaci√≥n a 35px para mejor control t√°ctil
  - Estados en espa√±ol con colores: activo (verde), inactivo (gris), de baja (rojo), vacaciones (azul)
  - Edici√≥n funcional: doble toque m√≥vil y doble click desktop para modal de edici√≥n
  - Filtro integrado de estados con "Activos" seleccionado por defecto
  - B√∫squeda y filtros integrados en una sola barra dentro de la lista de empleados
  - Contador din√°mico que muestra empleados filtrados del total disponible
  - Modal de edici√≥n completo restaurado con controles de ajuste manual de vacaciones (+/-)
  - Campos corporativos editables: email, tel√©fono, cargo, fecha incorporaci√≥n, estado
  - Funcionalidad de guardado con validaci√≥n y mensajes de confirmaci√≥n
  - Filtro de estado corregido para mapear correctamente valores espa√±ol-ingl√©s
  - Email y tel√©fono clickeables en lista PC: mailto/tel links priorizando corporativo
  - Roles traducidos al espa√±ol: "employee" = "Empleado"
  - Corregidas todas las vacaciones seg√∫n normativa espa√±ola: Juan P√©rez 0 d√≠as (reci√©n incorporado), Juan Ram√≠rez 24 d√≠as (9.6 meses trabajados), Admin 30 d√≠as (a√±o completo)
  - P√°gina de configuraci√≥n completamente redise√±ada: pesta√±as Empresa/Pol√≠ticas/Mi Perfil con interfaz clara y campos bien visibles
  - Cambiado "Usuario" por "Configuraci√≥n" en navegaci√≥n para admin
  - Lista de empleados reorganizada: eliminados DNI, fechas, vacaciones; email/tel√©fono inteligente (corporativo primero)
  - Interacciones mejoradas: doble click/tap para editar, click simple en email/tel√©fono para acciones directas
  - Llamadas por swipe Android: di√°logo confirmaci√≥n + m√∫ltiples m√©todos compatibilidad
- June 20, 2025. Sistema completo de gesti√≥n de empleados para admin implementado
  - Modal de edici√≥n de empleados clickeable con todos los campos corporativos editables
  - Campo de estado del empleado: activo, inactivo, de baja, de vacaciones con badges visuales
  - Interfaz para ajustar d√≠as de vacaciones extra (+/-) con botones y campo num√©rico
  - Secci√≥n de solo lectura para datos personales del empleado (email, tel√©fono, direcci√≥n)
  - API endpoint PATCH /api/employees/:id para actualizaci√≥n de campos corporativos
  - Rec√°lculo autom√°tico de vacaciones cuando se cambia fecha de incorporaci√≥n
  - Nuevo campo 'status' agregado a base de datos con migraci√≥n autom√°tica
- June 20, 2025. Sistema de vacaciones espa√±ol completo implementado con c√°lculo autom√°tico
  - C√°lculo autom√°tico basado en normativa espa√±ola: 30 d√≠as naturales/a√±o (2.5 d√≠as por mes trabajado)
  - Nuevos campos en usuarios: d√≠as por mes personalizables y ajustes manuales del admin
  - API endpoints para rec√°lculo autom√°tico (/api/users/:id/calculate-vacation) y ajustes (/api/users/:id/vacation-adjustment)
  - Funci√≥n calculateVacationDays() en storage que calcula d√≠as basado en fecha de incorporaci√≥n
  - Sistema configurable por empresa en company_configs.defaultVacationPolicy
  - Juan Ram√≠rez actualizado: sept 2024 entrada ‚Üí 10 d√≠as totales (3.7 meses √ó 2.5), 7 usados, 3 disponibles
- June 20, 2025. Mejoras en UI/UX de vacaciones y correcci√≥n de anchura de contenedores
  - Mensaje personalizado cuando se exceden d√≠as disponibles: "Ojal√° pudi√©ramos darte m√°s..."
  - Barra de progreso redise√±ada con mayor grosor (24px) y efectos shimmer animados
  - Correcci√≥n de c√°lculos: d√≠as disponibles = total - usados (pendientes no reducen disponibles)
  - Padding consistente (px-6) en todos los contenedores de vacaciones y horas de empleados
  - Gradientes mejorados con efectos de resplandor y sombras internas en barras de progreso
- June 20, 2025. Sistema unificado de notificaciones implementado con arquitectura escalable
  - Nueva tabla `notifications` con soporte para m√∫ltiples tipos de notificaciones
  - API endpoints unificados: /api/notifications con filtrado por categor√≠a
  - Componente React completo para gesti√≥n de notificaciones con pesta√±as por categor√≠a
  - Soporte para notificaciones de documentos, mensajes, vacaciones, sistema y recordatorios
  - Estados de lectura y completado independientes con actualizaciones en tiempo real
  - Prioridades configurables (alta, media, baja) con indicadores visuales
  - Fechas l√≠mite con recordatorios autom√°ticos para acciones pendientes
  - Backward compatibility mantenida con sistema legacy de document_notifications
- June 20, 2025. P√°gina de documentos para empleados completamente redise√±ada
  - Categorizaci√≥n autom√°tica de documentos (n√≥minas, contratos, otros)
  - Sistema de notificaciones para documentos requeridos con fechas l√≠mite
  - Interfaz modal para subida de documentos espec√≠ficos solicitados
  - Visualizaci√≥n directa de PDFs en nueva pesta√±a del navegador
  - Descarga segura de documentos con autenticaci√≥n por token
  - Filtrado por categor√≠as con iconos diferenciados por tipo
  - B√∫squeda en tiempo real de documentos por nombre
  - Interfaz completamente en espa√±ol con mensajes localizados
- June 20, 2025. Sistema de b√∫squeda y mensajes grupales implementado para admin/manager
  - Campo de b√∫squeda en tiempo real para filtrar empleados por nombre
  - Modo grupal activable con bot√≥n "Grupal" para selecci√≥n m√∫ltiple
  - Checkboxes visuales para seleccionar empleados en modo grupal
  - Botones "Todos" y "Ninguno" para selecci√≥n r√°pida masiva
  - Panel de mensaje grupal con contador de empleados seleccionados
  - Env√≠o simult√°neo de mensajes a m√∫ltiples empleados con un solo clic
  - Sistema de normalizaci√≥n de may√∫sculas/min√∫sculas en login (DNI/email)
  - Validaci√≥n mejorada con mensajes de error amigables y estados de carga
- June 20, 2025. Sistema de mensajer√≠a estilo WhatsApp implementado con roles diferenciados
  - P√°gina de mensajes completamente redise√±ada con interfaz estilo WhatsApp
  - Vista diferenciada: empleados ven managers, admin/manager ven empleados
  - Notificaciones del sistema para n√≥minas, documentos y recordatorios
  - Chat en tiempo real con burbujas de mensaje y scroll autom√°tico
  - Endpoint /api/managers para acceso de empleados a sus responsables
  - Indicador de mensajes no le√≠dos en dashboard con actualizaci√≥n autom√°tica
  - Interfaz m√≥vil-first optimizada con avatares y contadores de mensajes
- June 19, 2025. Sistema de carga personalizado con spinner arm√≥nico de Oficaz implementado
  - Spinner redise√±ado con c√≠rculo contorno y c√≠rculo relleno giratorio interno
  - Proporciones arm√≥nicas: grosor del contorno igual al di√°metro del c√≠rculo interno
  - Colores adaptativos: blanco en fondo oscuro, oscuro en fondo claro
  - Integrado en todas las p√°ginas y transiciones del sistema
  - Mensajes espec√≠ficos por ruta durante las cargas
  - Eliminado √°rea blanca en iPhone con fondo s√≥lido y safe areas
- June 19, 2025. Navegaci√≥n t√°ctil completa en p√°gina de fichajes de empleados
  - Gestos de deslizamiento implementados para navegaci√≥n intuitiva en m√≥vil
  - Deslizar izquierda/derecha para navegar entre meses manteniendo flechas
  - Gr√°fica de barras de √∫ltimos 4 meses con datos ficticios realistas
  - Navegaci√≥n limitada al mes actual, flecha de avance se oculta autom√°ticamente
  - Formato de fechas compacto sin saltos de l√≠nea en tabla
  - Soluci√≥n completa de problemas de scroll en m√≥vil con altura m√≠nima fija
- June 19, 2025. Vista simplificada de empleado implementada siguiendo dise√±o de referencia m√≥vil-first
  - Fondo con gradiente radial id√©ntico al login (#323A46 centro, #232B36 exterior)
  - Dise√±o estilo iPhone: √≠conos cuadrados con texto debajo, grid 3x3 con espaciado amplio
  - Bot√≥n circular "FICHAR" grande posicionado para acceso f√°cil con pulgar
  - Informaci√≥n de √∫ltimo fichaje siempre visible (ayer, semana pasada, etc.)
  - Logo peque√±o de Oficaz con copyright en la parte inferior
  - Header con nombre empleado y bot√≥n salir, logo central con nombre de empresa
  - Hora eliminada debajo del bot√≥n como solicitado
  - Scroll discreto implementado (4px, visible solo en hover)
- June 19, 2025. Sistema completamente funcional con perfil de usuario en header y gesti√≥n de empleados
  - Perfil de usuario movido del sidebar al header con dropdown funcional
  - P√°gina de empleados completamente actualizada con nueva estructura de base de datos
  - Correcciones completas en backend para manejo de campos requeridos
  - Base de datos pulida con todas las relaciones y restricciones funcionando correctamente
  - Sistema de creaci√≥n de empleados funcionando sin errores
  - Eliminaci√≥n completa de referencias a "usuario/username" del sistema
- June 19, 2025. Restructuraci√≥n completa de la base de datos de usuarios con campos expandidos
  - Nueva estructura de usuarios con campos categorizados (identificaci√≥n, laborales, direcci√≥n, vacaciones, emergencia)
  - Separaci√≥n de email personal y empresarial con permisos diferenciados
  - Sistema de permisos por roles: admin puede crear manager/empleado, manager puede crear empleados
  - Campos de contacto de emergencia y direcci√≥n postal para empleados
  - Sistema de vacaciones con d√≠as totales asignados y d√≠as utilizados
  - Tracking de qui√©n cre√≥ cada usuario y fechas de incorporaci√≥n
  - Metadatos completos con created_at y updated_at
- June 19, 2025. Implementaci√≥n completa del sistema de dise√±o moderno y logo oficial
  - Logo oficial de Oficaz integrado en todas las p√°ginas (login, registro, sidebar)
  - Sistema de dise√±o moderno implementado con color primario #007AFF exacto
  - Fondos con degradado radial (#323A46 centro, #232B36 exterior) en p√°ginas de autenticaci√≥n
  - Bordes redondeados consistentes (15px para contenedores grandes, proporcionales para peque√±os)
  - Sombras sutiles a√±adidas para profundidad visual moderna
  - Enrutamiento din√°mico por empresa completamente funcional (/test/dashboard, etc.)
  - Soporte completo para DNI y NIE en autenticaci√≥n con placeholders actualizados
- June 19, 2025. Complete elimination of username system - migrated to DNI/email authentication
  - Removed username field entirely from database schema and application logic
  - Authentication now exclusively uses DNI or email as login credentials
  - Updated all backend routes, middleware, and storage functions for new auth system
  - Frontend components updated to use fullName instead of firstName/lastName fields
  - Company registration system enhanced with comprehensive business data collection
  - Database migration executed to remove username column and make DNI required
  - All TypeScript errors resolved for seamless username-free operation
- June 19, 2025. Enhanced authentication and company registration system
  - Implemented comprehensive company registration system with business data collection
  - Updated login to accept either username or email in single input field
  - Enhanced database schema with company configurations and expanded user fields
  - Fixed token authentication issues for employee management
  - Added CIF, contact details, company alias, and configuration management
  - Complete Spanish interface maintained throughout new features
- June 19, 2025. Complete Oficaz employee management system deployed
  - Built full-stack React + Express application with TypeScript
  - Implemented JWT authentication with role-based access control
  - Created comprehensive employee management features
  - Added time tracking, vacation requests, document management, and messaging
  - Configured Supabase database integration
  - Application successfully running and accessible
- June 18, 2025. Initial setup

## User Preferences

Preferred communication style: Simple, everyday language.

## Design System Implementation

- June 23, 2025. Sistema de dise√±o CSS unificado implementado
  - Creado sistema completo de clases CSS estandarizadas para toda la aplicaci√≥n
  - Tipograf√≠a: heading-1 a heading-4, body-text, caption-text, label-text
  - Botones: btn-oficaz-primary, secondary, outline, success, danger con hovers consistentes
  - Iconos: icon-sm/md/lg/xl con tama√±os est√°ndar (16px, 20px, 24px, 32px)
  - Tarjetas: card-oficaz y card-oficaz-hover con estructura header/content
  - Inputs: input-oficaz con estados focus y error estandarizados
  - Badges: badge-success/warning/danger/info/neutral para estados
  - Efectos hover: hover-lift, hover-scale, hover-bg-oficaz con duraci√≥n 200ms
  - Espaciado: section-spacing, form-spacing, grid-spacing consistente
  - Documentaci√≥n completa en /styles/design-system.md
  - Colores Oficaz: #007AFF primario, escala de grises estructurada
  - Transiciones uniformes de 200ms en toda la aplicaci√≥n